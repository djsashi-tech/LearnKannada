<!DOCTYPE html>
<html lang="kn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> (Kannada Kaliyona) - Enhanced</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Kannada:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Base Styles */
        body {
            font-family: 'Noto Sans Kannada', sans-serif;
            user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
            touch-action: manipulation;
            background-color: #f7fafc; /* Lighter gray background */
        }
        button { min-height: 48px; min-width: 48px; }

        /* Main Display Area */
        #displayArea {
            font-size: clamp(2.5rem, 12vw, 7rem); /* Adjusted for better sentence fit */
            line-height: 1.3;
            font-weight: bold;
            text-align: centre;
            min-height: 250px; /* Slightly reduced min-height */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: default;
            background-color: #ffffff; /* White background */
            border-radius: 1rem;
            border: 1px solid #e2e8f0; /* Softer border */
            color: #2d3748; /* Darker gray text */
            margin-bottom: 1.5rem; /* Increased margin */
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* Message & Recognition Boxes */
        #messageBox, #recognizedText {
            min-height: 55px; /* Increased height */
            font-size: 1.1rem;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            display: flex; /* Use flexbox for alignment */
            align-items: center;
            justify-content: center;
            gap: 0.5rem; /* Space between icon and text */
            font-weight: 500;
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth transitions */
        }

        /* Button Styles */
        .nav-button {
            background-color: #4299e1; /* Tailwind Blue 500 */
            color: white;
            font-weight: bold;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease, opacity 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            display: inline-flex; /* Align icon and text */
            align-items: center;
            gap: 0.5rem;
        }
        .nav-button:hover:not(:disabled) { background-color: #3182ce; } /* Blue 600 */
        .nav-button:active:not(:disabled) { transform: scale(0.97); }
        .nav-button:disabled { background-color: #a0aec0; cursor: not-allowed; opacity: 0.7; } /* Gray 500 */

        .action-button { background-color: #48bb78; } /* Green 500 */
        .action-button:hover:not(:disabled) { background-color: #38a169; } /* Green 600 */
        .record-button { background-color: #f56565; } /* Red 500 */
        .record-button:hover:not(:disabled) { background-color: #e53e3e; } /* Red 600 */
        .record-button.recording { background-color: #ed8936; animation: pulse 1.5s infinite; } /* Orange 500 */

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(237, 137, 54, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(237, 137, 54, 0); }
            100% { box-shadow: 0 0 0 0 rgba(237, 137, 54, 0); }
        }

        /* Lesson Title */
        #lessonTitle {
            font-size: 1.3rem; /* Slightly smaller */
            font-weight: 600;
            color: #5a67d8; /* Indigo 600 */
            margin-bottom: 0.5rem; /* Reduced margin */
            text-align: center;
        }

        /* Progress Bar */
        #progressBarContainer {
            width: 100%;
            background-color: #e2e8f0; /* Gray 300 */
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 1rem;
            height: 1rem; /* Bar height */
        }
        #progressBar {
            height: 100%;
            width: 0%; /* Starts at 0 */
            background-color: #68d391; /* Green 400 */
            border-radius: 0.5rem;
            transition: width 0.5s ease-in-out;
            text-align: center;
            color: white;
            font-size: 0.75rem;
            line-height: 1rem; /* Center text vertically */
        }

        /* Validation Styles */
        .validation-correct {
            background-color: #c6f6d5; /* Green 100 */
            color: #2f855a; /* Green 700 */
            border: 1px solid #9ae6b4; /* Green 300 */
        }
        .validation-incorrect {
            background-color: #fed7d7; /* Red 100 */
            color: #c53030; /* Red 700 */
            border: 1px solid #feb2b2; /* Red 300 */
        }
         .validation-listening {
            background-color: #feebc8; /* Orange 100 */
            color: #9c4221; /* Orange 800 */
            border: 1px solid #fbd38d; /* Orange 300 */
        }
         .validation-default {
            background-color: #e2e8f0; /* Gray 300 */
            color: #4a5568; /* Gray 700 */
            border: 1px solid #cbd5e0; /* Gray 400 */
         }
         .message-info {
             background-color: #bee3f8; /* Blue 100 */
             color: #2b6cb0; /* Blue 700 */
             border: 1px solid #90cdf4; /* Blue 300 */
         }
         .message-error {
             background-color: #fed7d7; /* Red 100 */
             color: #c53030; /* Red 700 */
             border: 1px solid #feb2b2; /* Red 300 */
         }

    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-4">

    <div class="w-full max-w-3xl mx-auto bg-white p-5 md:p-7 rounded-xl shadow-lg">
        <h1 class="text-2xl md:text-3xl font-bold text-center text-gray-700 mb-3">‡≤ï‡≤®‡≥ç‡≤®‡≤° ‡≤ï‡≤≤‡≤ø‡≤Ø‡≥ã‡≤£</h1>

        <div id="progressBarContainer" title="‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤™‡≥ç‡≤∞‡≤ó‡≤§‡≤ø (Your Progress)">
            <div id="progressBar"></div>
        </div>

        <div id="lessonTitle">‡≤™‡≤æ‡≤†‡≤¶ ‡≤∂‡≥Ä‡≤∞‡≥ç‡≤∑‡≤ø‡≤ï‡≥Ü</div>
        <p class="text-center text-gray-500 mb-4 text-base">‡≤ï‡≥Ü‡≤≥‡≤ó‡≤ø‡≤®‡≤¶‡≤®‡≥ç‡≤®‡≥Å ‡≤ì‡≤¶‡≤ø ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å '‡≤π‡≥á‡≤≥‡≤ø' ‡≤¨‡≤ü‡≤®‡≥ç ‡≤í‡≤§‡≥ç‡≤§‡≤ø‡≤∞‡≤ø</p>

        <div id="displayArea"></div>

        <div class="flex justify-between mt-5 mb-5">
            <button id="prevButton" class="nav-button" title="‡≤π‡≤ø‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å (Previous)">
                <i class="fas fa-arrow-left"></i> ‡≤π‡≤ø‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å
            </button>
            <button id="nextButton" class="nav-button" title="‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å (Next)">
                ‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <div class="flex flex-col sm:flex-row justify-center items-center gap-3 mt-4">
            <button id="speakButton" class="nav-button action-button w-full sm:w-auto" title="‡≤ï‡≥á‡≤≥‡≤ø (Listen)">
                <i class="fas fa-volume-up"></i> ‡≤ï‡≥á‡≤≥‡≤ø
            </button>
            <button id="recordButton" class="nav-button record-button w-full sm:w-auto" title="‡≤π‡≥á‡≤≥‡≤ø (Speak)">
                 <i class="fas fa-microphone"></i> ‡≤π‡≥á‡≤≥‡≤ø
            </button>
        </div>

        <div id="messageBox" class="mt-5 message-info">
             <i class="fas fa-info-circle"></i> <span>‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠‡≤ø‡≤∏‡≤≤‡≥Å ‡≤∏‡≤ø‡≤¶‡≥ç‡≤ß!</span>
        </div>
         <div id="recognizedText" class="mt-3 validation-default">
             <i class="fas fa-comment-dots"></i> <span>‡≤®‡≥Ä‡≤µ‡≥Å ‡≤π‡≥á‡≤≥‡≤ø‡≤¶‡≥ç‡≤¶‡≥Å ‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤ï‡≤æ‡≤£‡≤ø‡≤∏‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü</span>
        </div>
    </div>

    <script>
        // --- Configuration & Content ---

        // Function to shuffle an array (Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
            return array;
        }

        // Define Lessons (Add more content here!)
        // NOTE: Content below is expanded sample data. Please review and add more for full lessons.
        const lessons = [
            {
                title: "‡≤™‡≤æ‡≤† 1: ‡≤∏‡≤∞‡≤≥ ‡≤™‡≤¶‡≤ó‡≤≥‡≥Å", // Simple Words
                shuffle: true, // Randomize this lesson
                content: [
                    "‡≤Æ‡≤®‡≥Ü", "‡≤®‡≥Ä‡≤∞‡≥Å", "‡≤ä‡≤ü", "‡≤ï‡≥Ü‡≤≤‡≤∏", "‡≤¨‡≤æ", "‡≤π‡≥ã‡≤ó‡≥Å", "‡≤ì‡≤¶‡≥Å", "‡≤®‡≥ã‡≤°‡≥Å", "‡≤á‡≤¶‡≥Å", "‡≤Ö‡≤¶‡≥Å",
                    "‡≤π‡≤£‡≥ç‡≤£‡≥Å", "‡≤π‡≥Ç‡≤µ‡≥Å", "‡≤Æ‡≤∞", "‡≤ó‡≤ø‡≤°", "‡≤¨‡≥Ä‡≤¶‡≤ø", "‡≤¶‡≤æ‡≤∞", "‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü", "‡≤ö‡≤π‡≤æ", "‡≤ï‡≤æ‡≤´‡≤ø", "‡≤π‡≤æ‡≤≤‡≥Å",
                    "‡≤Æ‡≥ä‡≤∏‡≤∞‡≥Å", "‡≤Ö‡≤ï‡≥ç‡≤ï‡≤ø", "‡≤¨‡≥á‡≤≥‡≥Ü", "‡≤§‡≤∞‡≤ï‡≤æ‡≤∞‡≤ø", "‡≤ó‡≤æ‡≤≥‡≤ø", "‡≤¨‡≥Ü‡≤≥‡≤ï‡≥Å", "‡≤∏‡≥Ç‡≤∞‡≥ç‡≤Ø", "‡≤ö‡≤Ç‡≤¶‡≥ç‡≤∞", "‡≤¶‡≤ø‡≤®", "‡≤∞‡≤æ‡≤§‡≥ç‡≤∞‡≤ø",
                    "‡≤¨‡≥Ü‡≤≥‡≤ø‡≤ó‡≥ç‡≤ó‡≥Ü", "‡≤∏‡≤Ç‡≤ú‡≥Ü", "‡≤Æ‡≤ß‡≥ç‡≤Ø‡≤æ‡≤π‡≥ç‡≤®", "‡≤π‡≤£", "‡≤Ö‡≤Ç‡≤ó‡≤°‡≤ø", "‡≤¶‡≤æ‡≤∞‡≤ø", "‡≤ä‡≤∞‡≥Å", "‡≤¶‡≥á‡≤∂", "‡≤∂‡≤æ‡≤≤‡≥Ü", "‡≤ï‡≤æ‡≤≤‡≥á‡≤ú‡≥Å",
                    "‡≤Ü‡≤ü", "‡≤™‡≤æ‡≤†", "‡≤π‡≤æ‡≤°‡≥Å", "‡≤Æ‡≤æ‡≤§‡≥Å", "‡≤®‡≤ó‡≥Å", "‡≤Ö‡≤≥‡≥Å", "‡≤®‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ü", "‡≤é‡≤ö‡≥ç‡≤ö‡≤∞", "‡≤∏‡≥ç‡≤µ‡≤≤‡≥ç‡≤™", "‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ",
                    "‡≤¶‡≥ä‡≤°‡≥ç‡≤°", "‡≤ö‡≤ø‡≤ï‡≥ç‡≤ï", "‡≤í‡≤≥‡≥ç‡≤≥‡≥Ü‡≤Ø", "‡≤ï‡≥Ü‡≤ü‡≥ç‡≤ü", "‡≤π‡≥ä‡≤∏", "‡≤π‡≤≥‡≥Ü‡≤Ø", "‡≤∏‡≥Å‡≤≤‡≤≠", "‡≤ï‡≤∑‡≥ç‡≤ü", "‡≤¨‡≥á‡≤ó", "‡≤®‡≤ø‡≤ß‡≤æ‡≤®",
                    "‡≤á‡≤≤‡≥ç‡≤≤‡≤ø", "‡≤Ö‡≤≤‡≥ç‡≤≤‡≤ø", "‡≤π‡≤§‡≥ç‡≤§‡≤ø‡≤∞", "‡≤¶‡≥Ç‡≤∞", "‡≤Æ‡≥á‡≤≤‡≥Ü", "‡≤ï‡≥Ü‡≤≥‡≤ó‡≥Ü", "‡≤í‡≤≥‡≤ó‡≥Ü", "‡≤π‡≥ä‡≤∞‡≤ó‡≥Ü", "‡≤Æ‡≥Å‡≤Ç‡≤¶‡≥Ü", "‡≤π‡≤ø‡≤Ç‡≤¶‡≥Ü",
                    "‡≤Ø‡≤æ‡≤∞‡≥Å", "‡≤è‡≤®‡≥Å", "‡≤Ø‡≤æ‡≤µ‡≤æ‡≤ó", "‡≤é‡≤≤‡≥ç‡≤≤‡≤ø", "‡≤π‡≥á‡≤ó‡≥Ü", "‡≤è‡≤ï‡≥Ü", "‡≤®‡≤æ‡≤®‡≥Å", "‡≤®‡≥Ä‡≤®‡≥Å", "‡≤Ö‡≤µ‡≤®‡≥Å", "‡≤Ö‡≤µ‡≤≥‡≥Å",
                    "‡≤Ö‡≤¶‡≥Å", "‡≤®‡≤æ‡≤µ‡≥Å", "‡≤®‡≥Ä‡≤µ‡≥Å", "‡≤Ö‡≤µ‡≤∞‡≥Å", "‡≤á‡≤µ‡≤∞‡≥Å", "‡≤Ö‡≤Æ‡≥ç‡≤Æ", "‡≤Ö‡≤™‡≥ç‡≤™", "‡≤Ö‡≤£‡≥ç‡≤£", "‡≤§‡≤Æ‡≥ç‡≤Æ", "‡≤Ö‡≤ï‡≥ç‡≤ï",
                    "‡≤§‡≤Ç‡≤ó‡≤ø", "‡≤ó‡≥Ü‡≤≥‡≥Ü‡≤Ø", "‡≤ó‡≥Ü‡≤≥‡≤§‡≤ø", "‡≤Æ‡≤ó‡≥Å", "‡≤¶‡≥á‡≤µ‡≤∞‡≥Å", "‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï", "‡≤™‡≥Ü‡≤®‡≥ç‡≤®‡≥Å", "‡≤¨‡≤£‡≥ç‡≤£", "‡≤∏‡≤∞‡≤ø", "‡≤§‡≤™‡≥ç‡≤™‡≥Å" // 100 words
                ]
            },
            {
                title: "‡≤™‡≤æ‡≤† 2: ‡≤é‡≤∞‡≤°‡≥Å ‡≤™‡≤¶‡≤ó‡≤≥ ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å", // Two Word Sentences
                shuffle: true, // Randomize this lesson
                content: [
                    "‡≤á‡≤¶‡≥Å ‡≤Æ‡≤®‡≥Ü.", "‡≤®‡≥Ä‡≤∞‡≥Å ‡≤ï‡≥Å‡≤°‡≤ø.", "‡≤Æ‡≤®‡≥Ü‡≤ó‡≥Ü ‡≤¨‡≤æ.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤¨‡≤Ç‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤π‡≥ã‡≤¶‡≤≥‡≥Å.", "‡≤ï‡≥Ü‡≤≤‡≤∏ ‡≤Æ‡≤æ‡≤°‡≥Å.", "‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï ‡≤ì‡≤¶‡≥Å.", "‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤®‡≤ó‡≥Å.", "‡≤¨‡≥á‡≤ó ‡≤¨‡≤æ.", "‡≤®‡≤ø‡≤ß‡≤æ‡≤® ‡≤π‡≥ã‡≤ó‡≥Å.",
                    "‡≤π‡≤£‡≥ç‡≤£‡≥Å ‡≤§‡≤ø‡≤®‡≥ç‡≤®‡≥Å.", "‡≤π‡≥Ç‡≤µ‡≥Å ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤Æ‡≤∞ ‡≤π‡≤§‡≥ç‡≤§‡≥Å.", "‡≤ó‡≤ø‡≤° ‡≤®‡≥Ü‡≤°‡≥Å.", "‡≤¨‡≥Ä‡≤¶‡≤ø ‡≤¶‡≤æ‡≤ü‡≥Å.", "‡≤¶‡≤æ‡≤∞ ‡≤π‡≤ø‡≤°‡≤ø.", "‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü ‡≤π‡≤æ‡≤ï‡≥Å.", "‡≤ö‡≤π‡≤æ ‡≤ï‡≥Å‡≤°‡≤ø.", "‡≤ï‡≤æ‡≤´‡≤ø ‡≤¨‡≥á‡≤°.", "‡≤π‡≤æ‡≤≤‡≥Å ‡≤ï‡≥ä‡≤°‡≥Å.",
                    "‡≤Æ‡≥ä‡≤∏‡≤∞‡≥Å ‡≤¨‡≥á‡≤ï‡≥Å.", "‡≤Ö‡≤ï‡≥ç‡≤ï‡≤ø ‡≤§‡≥ä‡≤≥‡≤ø.", "‡≤¨‡≥á‡≤≥‡≥Ü ‡≤¨‡≥á‡≤Ø‡≤ø‡≤∏‡≥Å.", "‡≤§‡≤∞‡≤ï‡≤æ‡≤∞‡≤ø ‡≤ï‡≤§‡≥ç‡≤§‡≤∞‡≤ø‡≤∏‡≥Å.", "‡≤ó‡≤æ‡≤≥‡≤ø ‡≤¨‡≥Ä‡≤∏‡≤ø‡≤§‡≥Å.", "‡≤¨‡≥Ü‡≤≥‡≤ï‡≥Å ‡≤¨‡≤Ç‡≤§‡≥Å.", "‡≤∏‡≥Ç‡≤∞‡≥ç‡≤Ø ‡≤Æ‡≥Ç‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤ö‡≤Ç‡≤¶‡≥ç‡≤∞ ‡≤ï‡≤æ‡≤£‡≤ø‡≤∏‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤¶‡≤ø‡≤® ‡≤ï‡≤≥‡≥Ü‡≤Ø‡≤ø‡≤§‡≥Å.", "‡≤∞‡≤æ‡≤§‡≥ç‡≤∞‡≤ø ‡≤Ü‡≤Ø‡≤ø‡≤§‡≥Å.",
                    "‡≤¨‡≥Ü‡≤≥‡≤ø‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤è‡≤≥‡≥Å.", "‡≤∏‡≤Ç‡≤ú‡≥Ü ‡≤¨‡≤æ.", "‡≤Æ‡≤ß‡≥ç‡≤Ø‡≤æ‡≤π‡≥ç‡≤® ‡≤ä‡≤ü.", "‡≤π‡≤£ ‡≤ï‡≥ä‡≤°‡≥Å.", "‡≤Ö‡≤Ç‡≤ó‡≤°‡≤ø ‡≤§‡≥Ü‡≤∞‡≥Ü‡≤¶‡≤ø‡≤¶‡≥Ü.", "‡≤¶‡≤æ‡≤∞‡≤ø ‡≤§‡≥ã‡≤∞‡≤ø‡≤∏‡≥Å.", "‡≤ä‡≤∞‡≥Å ‡≤§‡≤≤‡≥Å‡≤™‡≤ø‡≤¶‡≥Ü.", "‡≤¶‡≥á‡≤∂ ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", "‡≤∂‡≤æ‡≤≤‡≥Ü ‡≤Æ‡≥Å‡≤ó‡≤ø‡≤Ø‡≤ø‡≤§‡≥Å.", "‡≤ï‡≤æ‡≤≤‡≥á‡≤ú‡≥Å ‡≤Ü‡≤∞‡≤Ç‡≤≠.",
                    "‡≤Ü‡≤ü ‡≤Ü‡≤°‡≥Å.", "‡≤™‡≤æ‡≤† ‡≤ï‡≤≤‡≤ø.", "‡≤π‡≤æ‡≤°‡≥Å ‡≤π‡≥á‡≤≥‡≥Å.", "‡≤Æ‡≤æ‡≤§‡≥Å ‡≤ï‡≥á‡≤≥‡≥Å.", "‡≤®‡≤ó‡≥Å ‡≤®‡≤ø‡≤≤‡≥ç‡≤≤‡≤ø‡≤∏‡≥Å.", "‡≤Ö‡≤≥‡≥Å ‡≤®‡≤ø‡≤≤‡≥ç‡≤≤‡≤ø‡≤∏‡≥Å.", "‡≤®‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ü ‡≤Æ‡≤æ‡≤°‡≥Å.", "‡≤é‡≤ö‡≥ç‡≤ö‡≤∞ ‡≤á‡≤∞‡≥Å.", "‡≤∏‡≥ç‡≤µ‡≤≤‡≥ç‡≤™ ‡≤ï‡≥ä‡≤°‡≥Å.", "‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤§‡≤ø‡≤®‡≥ç‡≤®‡≥Å.",
                    "‡≤¶‡≥ä‡≤°‡≥ç‡≤° ‡≤Æ‡≤®‡≥Ü.", "‡≤ö‡≤ø‡≤ï‡≥ç‡≤ï ‡≤Æ‡≤ó‡≥Å.", "‡≤í‡≤≥‡≥ç‡≤≥‡≥Ü‡≤Ø ‡≤π‡≥Å‡≤°‡≥Å‡≤ó.", "‡≤ï‡≥Ü‡≤ü‡≥ç‡≤ü ‡≤ï‡≤®‡≤∏‡≥Å.", "‡≤π‡≥ä‡≤∏ ‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü.", "‡≤π‡≤≥‡≥Ü‡≤Ø ‡≤®‡≥Ü‡≤®‡≤™‡≥Å.", "‡≤∏‡≥Å‡≤≤‡≤≠ ‡≤™‡≥ç‡≤∞‡≤∂‡≥ç‡≤®‡≥Ü.", "‡≤ï‡≤∑‡≥ç‡≤ü ‡≤ï‡≥Ü‡≤≤‡≤∏.", "‡≤¨‡≥á‡≤ó ‡≤¨‡≤æ.", "‡≤®‡≤ø‡≤ß‡≤æ‡≤® ‡≤π‡≥ã‡≤ó‡≥Å.",
                    "‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤á‡≤°‡≥Å.", "‡≤Ö‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤π‡≤§‡≥ç‡≤§‡≤ø‡≤∞ ‡≤¨‡≤æ.", "‡≤¶‡≥Ç‡≤∞ ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Æ‡≥á‡≤≤‡≥Ü ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤ï‡≥Ü‡≤≥‡≤ó‡≥Ü ‡≤á‡≤≥‡≤ø‡≤∏‡≥Å.", "‡≤í‡≤≥‡≤ó‡≥Ü ‡≤¨‡≤æ.", "‡≤π‡≥ä‡≤∞‡≤ó‡≥Ü ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Æ‡≥Å‡≤Ç‡≤¶‡≥Ü ‡≤∏‡≤∞‡≤ø.", "‡≤π‡≤ø‡≤Ç‡≤¶‡≥Ü ‡≤®‡≥ã‡≤°‡≥Å.",
                    "‡≤Ø‡≤æ‡≤∞‡≥Å ‡≤¨‡≤Ç‡≤¶‡≤∞‡≥Å?", "‡≤è‡≤®‡≥Å ‡≤¨‡≥á‡≤ï‡≥Å?", "‡≤Ø‡≤æ‡≤µ‡≤æ‡≤ó ‡≤¨‡≤∞‡≥Å‡≤µ‡≥Ü?", "‡≤é‡≤≤‡≥ç‡≤≤‡≤ø ‡≤π‡≥ã‡≤¶‡≥Ü?", "‡≤π‡≥á‡≤ó‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≥Ü?", "‡≤è‡≤ï‡≥Ü ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≥Ü?", "‡≤®‡≤æ‡≤®‡≥Å ‡≤¨‡≤Ç‡≤¶‡≥Ü.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≤≥‡≥Å.",
                    "‡≤Ö‡≤¶‡≥Å ‡≤π‡≤æ‡≤∞‡≤ø‡≤§‡≥Å.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤ó‡≥Ü‡≤¶‡≥ç‡≤¶‡≥Ü‡≤µ‡≥Å.", "‡≤®‡≥Ä‡≤µ‡≥Å ‡≤∏‡≥ã‡≤§‡≤∞‡≥Å.", "‡≤Ö‡≤µ‡≤∞‡≥Å ‡≤¨‡≤Ç‡≤¶‡≤∞‡≥Å.", "‡≤á‡≤µ‡≤∞‡≥Å ‡≤Ø‡≤æ‡≤∞‡≥Å?", "‡≤Ö‡≤Æ‡≥ç‡≤Æ ‡≤ï‡≤∞‡≥Ü‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤™‡≥ç‡≤™ ‡≤π‡≥á‡≤≥‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤£‡≥ç‡≤£ ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤§‡≤Æ‡≥ç‡≤Æ ‡≤Ü‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤ï‡≥ç‡≤ï ‡≤ì‡≤¶‡≤ø‡≤¶‡≤≥‡≥Å.",
                    "‡≤§‡≤Ç‡≤ó‡≤ø ‡≤Æ‡≤≤‡≤ó‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤ó‡≥Ü‡≤≥‡≥Ü‡≤Ø ‡≤¨‡≤Ç‡≤¶‡≤®‡≥Å.", "‡≤ó‡≥Ü‡≤≥‡≤§‡≤ø ‡≤π‡≥ã‡≤¶‡≤≥‡≥Å.", "‡≤Æ‡≤ó‡≥Å ‡≤Ö‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü.", "‡≤¶‡≥á‡≤µ‡≤∞‡≥Å ‡≤á‡≤¶‡≥ç‡≤¶‡≤æ‡≤®‡≥Ü.", "‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï ‡≤ï‡≥ä‡≤°‡≥Å.", "‡≤™‡≥Ü‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤ó‡≥ã.", "‡≤¨‡≤£‡≥ç‡≤£ ‡≤π‡≤ö‡≥ç‡≤ö‡≥Å.", "‡≤∏‡≤∞‡≤ø ‡≤π‡≥á‡≤≥‡≥Å.", "‡≤§‡≤™‡≥ç‡≤™‡≥Å ‡≤Æ‡≤æ‡≤°‡≤¨‡≥á‡≤°." // 100 sentences
                ]
            },
            {
                title: "‡≤™‡≤æ‡≤† 3: ‡≤Æ‡≥Ç‡≤∞‡≥Å ‡≤™‡≤¶‡≤ó‡≤≥ ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å", // Three Word Sentences
                shuffle: true, // Randomize this lesson
                content: [
                    "‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤ï‡≥Å‡≤°‡≤ø‡≤¶‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤∂‡≤æ‡≤≤‡≥Ü‡≤ó‡≥Ü ‡≤π‡≥ã‡≤¶‡≤≥‡≥Å.", "‡≤á‡≤¶‡≥Å ‡≤¶‡≥ä‡≤°‡≥ç‡≤° ‡≤Æ‡≤®‡≥Ü.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤ì‡≤¶‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤®‡≥Ü.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü ‡≤¨‡≤∞‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤µ‡≥Ü.", "‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤¨‡≤æ.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤ï‡≥Ü‡≤≤‡≤∏ ‡≤Æ‡≤æ‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤®‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤π‡≤æ‡≤°‡≥Å ‡≤π‡≥á‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤≥‡≥Ü.", "‡≤Æ‡≤ó‡≥Å ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤®‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤Ü‡≤ü ‡≤Ü‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤µ‡≥Ü.",
                    "‡≤®‡≤æ‡≤®‡≥Å ‡≤π‡≤£‡≥ç‡≤£‡≥Å ‡≤§‡≤ø‡≤Ç‡≤¶‡≥Ü‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤π‡≥Ç‡≤µ‡≥Å ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤Æ‡≤∞ ‡≤π‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤ó‡≤ø‡≤° ‡≤®‡≥Ü‡≤ü‡≥ç‡≤ü‡≥Ü‡≤µ‡≥Å.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤¨‡≥Ä‡≤¶‡≤ø ‡≤¶‡≤æ‡≤ü‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤¶‡≤æ‡≤∞ ‡≤π‡≤ø‡≤°‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü ‡≤π‡≤æ‡≤ï‡≤ø‡≤¶‡≥Ü‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤ö‡≤π‡≤æ ‡≤ï‡≥Å‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≤ø‡≤ó‡≥Ü ‡≤ï‡≤æ‡≤´‡≤ø ‡≤¨‡≥á‡≤°.", "‡≤Ö‡≤Æ‡≥ç‡≤Æ ‡≤π‡≤æ‡≤≤‡≥Å ‡≤ï‡≥ä‡≤ü‡≥ç‡≤ü‡≤∞‡≥Å.",
                    "‡≤®‡≤®‡≤ó‡≥Ü ‡≤Æ‡≥ä‡≤∏‡≤∞‡≥Å ‡≤¨‡≥á‡≤ï‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤Ö‡≤ï‡≥ç‡≤ï‡≤ø ‡≤§‡≥ä‡≤≥‡≥Ü‡≤¶‡≤≥‡≥Å.", "‡≤Ö‡≤™‡≥ç‡≤™ ‡≤¨‡≥á‡≤≥‡≥Ü ‡≤§‡≤Ç‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤Æ‡≥ç‡≤Æ ‡≤§‡≤∞‡≤ï‡≤æ‡≤∞‡≤ø ‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤§‡≤£‡≥ç‡≤£‡≤®‡≥Ü ‡≤ó‡≤æ‡≤≥‡≤ø ‡≤¨‡≥Ä‡≤∏‡≤ø‡≤§‡≥Å.", "‡≤™‡≥ç‡≤∞‡≤ï‡≤æ‡≤∂‡≤Æ‡≤æ‡≤® ‡≤¨‡≥Ü‡≤≥‡≤ï‡≥Å ‡≤¨‡≤Ç‡≤§‡≥Å.", "‡≤∏‡≥Ç‡≤∞‡≥ç‡≤Ø ‡≤™‡≥Ç‡≤∞‡≥ç‡≤µ‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤Æ‡≥Ç‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤ö‡≤Ç‡≤¶‡≥ç‡≤∞ ‡≤Ü‡≤ï‡≤æ‡≤∂‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤ï‡≤æ‡≤£‡≤ø‡≤∏‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤¶‡≤ø‡≤® ‡≤¨‡≥á‡≤ó ‡≤ï‡≤≥‡≥Ü‡≤Ø‡≤ø‡≤§‡≥Å.", "‡≤∞‡≤æ‡≤§‡≥ç‡≤∞‡≤ø ‡≤®‡≤ø‡≤ß‡≤æ‡≤®‡≤µ‡≤æ‡≤ó‡≤ø ‡≤Ü‡≤Ø‡≤ø‡≤§‡≥Å.",
                    "‡≤®‡≤æ‡≤®‡≥Å ‡≤¨‡≥Ü‡≤≥‡≤ø‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤¨‡≥á‡≤ó ‡≤é‡≤¶‡≥ç‡≤¶‡≥Ü.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤∏‡≤Ç‡≤ú‡≥Ü ‡≤Æ‡≤®‡≥Ü‡≤ó‡≥Ü ‡≤¨‡≤æ.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤Æ‡≤ß‡≥ç‡≤Ø‡≤æ‡≤π‡≥ç‡≤® ‡≤ä‡≤ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≥Ü‡≤µ‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤®‡≤®‡≤ó‡≥Ü ‡≤π‡≤£ ‡≤ï‡≥ä‡≤ü‡≥ç‡≤ü‡≤®‡≥Å.", "‡≤Ö‡≤Ç‡≤ó‡≤°‡≤ø ‡≤à‡≤ó ‡≤§‡≥Ü‡≤∞‡≥Ü‡≤¶‡≤ø‡≤¶‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤¶‡≤æ‡≤∞‡≤ø ‡≤§‡≥ã‡≤∞‡≤ø‡≤∏‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤ä‡≤∞‡≥Å ‡≤§‡≤≤‡≥Å‡≤™‡≤ø‡≤¶‡≥Ü‡≤®‡≥Å.", "‡≤®‡≤Æ‡≥ç‡≤Æ ‡≤¶‡≥á‡≤∂ ‡≤∏‡≥Å‡≤Ç‡≤¶‡≤∞‡≤µ‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", "‡≤∂‡≤æ‡≤≤‡≥Ü ‡≤®‡≤æ‡≤≥‡≥Ü ‡≤∞‡≤ú‡≥Ü.", "‡≤ï‡≤æ‡≤≤‡≥á‡≤ú‡≥Å ‡≤∏‡≥ã‡≤Æ‡≤µ‡≤æ‡≤∞ ‡≤Ü‡≤∞‡≤Ç‡≤≠.",
                    "‡≤Æ‡≤ï‡≥ç‡≤ï‡≤≥‡≥Å ‡≤Ü‡≤ü ‡≤Ü‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤∞‡≥Ü.", "‡≤µ‡≤ø‡≤¶‡≥ç‡≤Ø‡≤æ‡≤∞‡≥ç‡≤•‡≤ø‡≤ó‡≤≥‡≥Å ‡≤™‡≤æ‡≤† ‡≤ï‡≤≤‡≤ø‡≤Ø‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤∞‡≥Ü.", "‡≤ó‡≤æ‡≤Ø‡≤ï‡≤ø ‡≤π‡≤æ‡≤°‡≥Å ‡≤π‡≥á‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤≥‡≥Ü.", "‡≤π‡≤ø‡≤∞‡≤ø‡≤Ø‡≤∞‡≥Å ‡≤Æ‡≤æ‡≤§‡≥Å ‡≤π‡≥á‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤∞‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤ú‡≥ã‡≤∞‡≤æ‡≤ó‡≤ø ‡≤®‡≤ï‡≥ç‡≤ï‡≤≥‡≥Å.", "‡≤Æ‡≤ó‡≥Å ‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤Ö‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤ó‡≤æ‡≤¢ ‡≤®‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤à‡≤ó ‡≤é‡≤ö‡≥ç‡≤ö‡≤∞‡≤µ‡≤æ‡≤¶‡≥Ü.", "‡≤®‡≤®‡≤ó‡≥Ü ‡≤∏‡≥ç‡≤µ‡≤≤‡≥ç‡≤™ ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤ï‡≥ä‡≤°‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤ä‡≤ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≤®‡≥Å.",
                    "‡≤á‡≤¶‡≥Å ‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤¶‡≥ä‡≤°‡≥ç‡≤° ‡≤Æ‡≤®‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤ö‡≤ø‡≤ï‡≥ç‡≤ï ‡≤Æ‡≤ó‡≥Å ‡≤Ö‡≤≤‡≥ç‡≤≤.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤í‡≤≥‡≥ç‡≤≥‡≥Ü‡≤Ø ‡≤π‡≥Å‡≤°‡≥Å‡≤ó ‡≤π‡≥å‡≤¶‡≥Å.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤ï‡≥Ü‡≤ü‡≥ç‡≤ü ‡≤ï‡≤®‡≤∏‡≥Å ‡≤ï‡≤Ç‡≤°‡≥Ü.", "‡≤á‡≤µ‡≥Å ‡≤π‡≥ä‡≤∏ ‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü‡≤ó‡≤≥‡≥Å.", "‡≤Ö‡≤¶‡≥Å ‡≤π‡≤≥‡≥Ü‡≤Ø ‡≤®‡≥Ü‡≤®‡≤™‡≥Å ‡≤Æ‡≤æ‡≤§‡≥ç‡≤∞.", "‡≤à ‡≤™‡≥ç‡≤∞‡≤∂‡≥ç‡≤®‡≥Ü ‡≤∏‡≥Å‡≤≤‡≤≠‡≤µ‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", "‡≤Ü ‡≤ï‡≥Ü‡≤≤‡≤∏ ‡≤ï‡≤∑‡≥ç‡≤ü‡≤ï‡≤∞‡≤µ‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤¨‡≥á‡≤ó ‡≤¨‡≤∞‡≤¨‡≥á‡≤ï‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤®‡≤ø‡≤ß‡≤æ‡≤®‡≤µ‡≤æ‡≤ó‡≤ø ‡≤π‡≥ã‡≤¶‡≤®‡≥Å.",
                    "‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤á‡≤°‡≥Å.", "‡≤Ü ‡≤ö‡≤ø‡≤§‡≥ç‡≤∞‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Ö‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤®‡≤®‡≥ç‡≤® ‡≤π‡≤§‡≥ç‡≤§‡≤ø‡≤∞ ‡≤¨‡≤æ.", "‡≤Ö‡≤µ‡≤®‡≤ø‡≤Ç‡≤¶ ‡≤¶‡≥Ç‡≤∞ ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Ü‡≤ï‡≤æ‡≤∂‡≤¶ ‡≤Æ‡≥á‡≤≤‡≥Ü ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤Æ‡≤∞‡≤¶‡≤ø‡≤Ç‡≤¶ ‡≤ï‡≥Ü‡≤≥‡≤ó‡≥Ü ‡≤á‡≤≥‡≤ø‡≤∏‡≥Å.", "‡≤Æ‡≤®‡≥Ü‡≤Ø ‡≤í‡≤≥‡≤ó‡≥Ü ‡≤¨‡≤æ.", "‡≤∂‡≤æ‡≤≤‡≥Ü‡≤Ø ‡≤π‡≥ä‡≤∞‡≤ó‡≥Ü ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤∏‡≤æ‡≤≤‡≤ø‡≤®‡≤≤‡≥ç‡≤≤‡≤ø ‡≤Æ‡≥Å‡≤Ç‡≤¶‡≥Ü ‡≤∏‡≤∞‡≤ø.", "‡≤ï‡≤®‡≥ç‡≤®‡≤°‡≤ø‡≤Ø ‡≤π‡≤ø‡≤Ç‡≤¶‡≥Ü ‡≤®‡≥ã‡≤°‡≥Å.",
                    "‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü ‡≤Ø‡≤æ‡≤∞‡≥Å ‡≤¨‡≤Ç‡≤¶‡≤∞‡≥Å?", "‡≤®‡≤ø‡≤®‡≤ó‡≥Ü ‡≤è‡≤®‡≥Å ‡≤¨‡≥á‡≤ï‡≥Å?", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤Ø‡≤æ‡≤µ‡≤æ‡≤ó ‡≤¨‡≤∞‡≥Å‡≤µ‡≥Ü?", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤é‡≤≤‡≥ç‡≤≤‡≤ø‡≤ó‡≥Ü ‡≤π‡≥ã‡≤¶‡≤®‡≥Å?", "‡≤á‡≤¶‡≤®‡≥ç‡≤®‡≥Å ‡≤π‡≥á‡≤ó‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≥Ü?", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤è‡≤ï‡≥Ü ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≥Ü?", "‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü ‡≤¨‡≤Ç‡≤¶‡≥Ü.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤∏‡≤ø‡≤®‡≤ø‡≤Æ‡≤æ ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤π‡≤æ‡≤°‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≤≥‡≥Å.",
                    "‡≤Ü ‡≤π‡≤ï‡≥ç‡≤ï‡≤ø ‡≤π‡≤æ‡≤∞‡≤ø‡≤§‡≥Å.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤™‡≤Ç‡≤¶‡≥ç‡≤Ø ‡≤ó‡≥Ü‡≤¶‡≥ç‡≤¶‡≥Ü‡≤µ‡≥Å.", "‡≤®‡≥Ä‡≤µ‡≥Å ‡≤è‡≤ï‡≥Ü ‡≤∏‡≥ã‡≤§‡≤∞‡≥Å?", "‡≤Ö‡≤µ‡≤∞‡≥Å ‡≤®‡≤æ‡≤ü‡≤ï ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤á‡≤µ‡≤∞‡≥Å ‡≤®‡≤®‡≥ç‡≤® ‡≤∏‡≥ç‡≤®‡≥á‡≤π‡≤ø‡≤§‡≤∞‡≥Å.", "‡≤Ö‡≤Æ‡≥ç‡≤Æ ‡≤Ö‡≤°‡≥Å‡≤ó‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤™‡≥ç‡≤™ ‡≤™‡≥á‡≤™‡≤∞‡≥ç ‡≤ì‡≤¶‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤£‡≥ç‡≤£ ‡≤ï‡≥ç‡≤∞‡≤ø‡≤ï‡≥Ü‡≤ü‡≥ç ‡≤Ü‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤§‡≤Æ‡≥ç‡≤Æ ‡≤∂‡≤æ‡≤≤‡≥Ü‡≤ó‡≥Ü ‡≤π‡≥ã‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤ï‡≥ç‡≤ï ‡≤ö‡≤ø‡≤§‡≥ç‡≤∞ ‡≤¨‡≤∞‡≥Ü‡≤¶‡≤≥‡≥Å.",
                    "‡≤§‡≤Ç‡≤ó‡≤ø ‡≤ó‡≥ä‡≤Ç‡≤¨‡≥Ü ‡≤Ü‡≤°‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤®‡≤®‡≥ç‡≤® ‡≤ó‡≥Ü‡≤≥‡≥Ü‡≤Ø ‡≤¨‡≤Ç‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥ ‡≤ó‡≥Ü‡≤≥‡≤§‡≤ø ‡≤π‡≥ã‡≤¶‡≤≥‡≥Å.", "‡≤Ü ‡≤Æ‡≤ó‡≥Å ‡≤Ö‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü.", "‡≤¶‡≥á‡≤µ‡≤∞‡≥Å ‡≤é‡≤≤‡≥ç‡≤≤‡≥Ü‡≤°‡≥Ü ‡≤á‡≤¶‡≥ç‡≤¶‡≤æ‡≤®‡≥Ü.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï ‡≤ì‡≤¶‡≤ø‡≤¶‡≥Ü‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤™‡≥Ü‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤Ç‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤¨‡≤£‡≥ç‡≤£ ‡≤π‡≤ö‡≥ç‡≤ö‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤∏‡≤∞‡≤ø ‡≤π‡≥á‡≤≥‡≤ø‡≤¶‡≥Ü.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤§‡≤™‡≥ç‡≤™‡≥Å ‡≤Æ‡≤æ‡≤°‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤." // 100 sentences
                ]
            },
            {
                title: "‡≤™‡≤æ‡≤† 4: ‡≤¶‡≥ä‡≤°‡≥ç‡≤° ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å", // Longer Sentences
                shuffle: false, // Keep longer sentences in order
                content: [
                    "‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü ‡≤¨‡≥Ü‡≤Ç‡≤ó‡≤≥‡≥Ç‡≤∞‡≤ø‡≤ó‡≥Ü ‡≤π‡≥ã‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤®‡≥Ü.",
                    "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü ‡≤Ö‡≤Ç‡≤ó‡≤°‡≤ø‡≤Ø‡≤ø‡≤Ç‡≤¶ ‡≤π‡≤£‡≥ç‡≤£‡≥Å ‡≤§‡≤Ç‡≤¶‡≤≥‡≥Å.",
                    "‡≤à ‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤®‡≤®‡≤ó‡≥Ü ‡≤ï‡≥ä‡≤°‡≤ø.",
                    "‡≤®‡≤æ‡≤µ‡≥Å ‡≤á‡≤Ç‡≤¶‡≥Å ‡≤∏‡≤Ç‡≤ú‡≥Ü ‡≤∏‡≤ø‡≤®‡≤ø‡≤Æ‡≤æ ‡≤®‡≥ã‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤µ‡≥Ü.",
                    "‡≤Æ‡≤ï‡≥ç‡≤ï‡≤≥‡≥Å ‡≤Ü‡≤ü‡≤¶ ‡≤Æ‡≥à‡≤¶‡≤æ‡≤®‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤Ü‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥ç‡≤¶‡≤æ‡≤∞‡≥Ü.",
                    "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤™‡≥ç‡≤∞‡≤§‡≤ø‡≤¶‡≤ø‡≤® ‡≤¨‡≥Ü‡≤≥‡≤ø‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤¨‡≥á‡≤ó ‡≤è‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤®‡≥Ü.",
                    "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤ï‡≤®‡≥ç‡≤®‡≤°‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤Æ‡≤æ‡≤§‡≤®‡≤æ‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤≥‡≥Ü.",
                    "‡≤®‡≤æ‡≤µ‡≥Å ‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤® ‡≤µ‡≤æ‡≤∞ ‡≤™‡≥ç‡≤∞‡≤µ‡≤æ‡≤∏ ‡≤π‡≥ã‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤µ‡≥Ü.",
                    "‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤¨‡≤æ‡≤ó‡≤ø‡≤≤‡≤®‡≥ç‡≤®‡≥Å ‡≤Æ‡≥Å‡≤ö‡≥ç‡≤ö‡≤ø ‡≤í‡≤≥‡≤ó‡≥Ü ‡≤¨‡≤®‡≥ç‡≤®‡≤ø.",
                    "‡≤à ‡≤ä‡≤ü ‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤∞‡≥Å‡≤ö‡≤ø‡≤ï‡≤∞‡≤µ‡≤æ‡≤ó‡≤ø ‡≤á‡≤¶‡≥Ü.",
                    // Add ~90 more longer sentences here
                    "‡≤Æ‡≤≥‡≥Ü ‡≤¨‡≤Ç‡≤¶ ‡≤ï‡≤æ‡≤∞‡≤£ ‡≤®‡≤æ‡≤µ‡≥Å ‡≤Æ‡≤®‡≥Ü‡≤Ø‡≤≤‡≥ç‡≤≤‡≥á ‡≤â‡≤≥‡≤ø‡≤¶‡≥Ü‡≤µ‡≥Å.",
                    "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤§‡≤®‡≥ç‡≤® ‡≤∏‡≥ç‡≤®‡≥á‡≤π‡≤ø‡≤§‡≤® ‡≤ú‡≥ä‡≤§‡≥Ü ‡≤Ü‡≤∏‡≥ç‡≤™‡≤§‡≥ç‡≤∞‡≥Ü‡≤ó‡≥Ü ‡≤π‡≥ã‡≤¶‡≤®‡≥Å.",
                    "‡≤®‡≤æ‡≤µ‡≥Å ‡≤¨‡≤∏‡≥ç‡≤∏‡≤ø‡≤®‡≤≤‡≥ç‡≤≤‡≤ø ‡≤™‡≥ç‡≤∞‡≤Ø‡≤æ‡≤£ ‡≤Æ‡≤æ‡≤°‡≤ø ‡≤¶‡≥á‡≤µ‡≤∏‡≥ç‡≤•‡≤æ‡≤® ‡≤§‡≤≤‡≥Å‡≤™‡≤ø‡≤¶‡≥Ü‡≤µ‡≥Å.",
                    "‡≤à ‡≤ï‡≤•‡≥Ü‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤®‡≤æ‡≤®‡≥Å ‡≤ö‡≤ø‡≤ï‡≥ç‡≤ï‡≤µ‡≤®‡≤ø‡≤¶‡≥ç‡≤¶‡≤æ‡≤ó ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ü.",
                    "‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≥Ü‡≤Ø‡≤≤‡≥ç‡≤≤‡≤ø ‡≤í‡≤≥‡≥ç‡≤≥‡≥Ü‡≤Ø ‡≤Ö‡≤Ç‡≤ï‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤™‡≤°‡≥Ü‡≤Ø‡≤≤‡≥Å ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤ì‡≤¶‡≤¨‡≥á‡≤ï‡≥Å."
                ]
            }
        ];

        // --- Global State ---
        let currentContentIndex = 0;
        let courseContent = []; // Will be populated after shuffling
        let synth = window.speechSynthesis;
        let recognition;
        let isRecording = false;
        let isCurrentItemCorrect = false; // Track if current item is validated

        // --- DOM Elements ---
        const displayArea = document.getElementById('displayArea');
        const lessonTitleElement = document.getElementById('lessonTitle');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const speakButton = document.getElementById('speakButton');
        const recordButton = document.getElementById('recordButton');
        const messageBox = document.getElementById('messageBox');
        const messageBoxIcon = messageBox.querySelector('i');
        const messageBoxText = messageBox.querySelector('span');
        const recognizedTextElement = document.getElementById('recognizedText');
        const recognizedTextIcon = recognizedTextElement.querySelector('i');
        const recognizedTextSpan = recognizedTextElement.querySelector('span');
        const progressBar = document.getElementById('progressBar');
        const progressBarContainer = document.getElementById('progressBarContainer');


        // --- Core Functions ---

        // Prepare course content (shuffle lessons if needed)
        function prepareCourseContent() {
            courseContent = []; // Reset
            lessons.forEach((lesson) => {
                let contentToAdd = lesson.content;
                // Shuffle content if the lesson requires it
                if (lesson.shuffle) {
                    contentToAdd = shuffleArray([...lesson.content]); // Shuffle a copy
                }
                // Add lesson info to each item
                contentToAdd.forEach((item, itemIndex) => {
                    courseContent.push({
                        text: item,
                        lessonTitle: lesson.title,
                        isFirstItemOfLesson: itemIndex === 0 // Mark the first item
                    });
                });
            });
            console.log(`Prepared ${courseContent.length} items.`);
        }

        // Update the display, progress, and buttons
        function updateDisplay() {
            if (courseContent.length === 0) return; // Do nothing if no content

            const currentItem = courseContent[currentContentIndex];
            displayArea.textContent = currentItem.text;
            lessonTitleElement.textContent = currentItem.lessonTitle;

            // Reset validation state for the new item
            isCurrentItemCorrect = false;
            resetValidationUI(); // Reset feedback area

            updateNavButtons();
            updateProgressBar();

            // Optional: Announce new lesson start
            if (currentItem.isFirstItemOfLesson && currentContentIndex > 0) {
                 showMessage(`‡≤π‡≥ä‡≤∏ ‡≤™‡≤æ‡≤† ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠: ${currentItem.lessonTitle}`, 'info');
            } else if (currentContentIndex === 0 && currentItem.isFirstItemOfLesson) {
                 showMessage(`‡≤™‡≤æ‡≤† ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠: ${currentItem.lessonTitle}`, 'info');
            }
        }

        // Update progress bar
        function updateProgressBar() {
            const progress = courseContent.length > 0 ? ((currentContentIndex + 1) / courseContent.length) * 100 : 0;
            progressBar.style.width = `${progress}%`;
            // Optional: Add text inside the bar
            // progressBar.textContent = `${Math.round(progress)}%`;
            progressBarContainer.title = `‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤™‡≥ç‡≤∞‡≤ó‡≤§‡≤ø: ${currentContentIndex + 1} / ${courseContent.length}`;
        }


        // Update Previous/Next button states
        function updateNavButtons() {
            prevButton.disabled = currentContentIndex === 0;
            // NEXT button is disabled if it's the last item OR if the current item is NOT validated yet
            nextButton.disabled = (currentContentIndex === courseContent.length - 1) || !isCurrentItemCorrect;

            // Visual cues for disabled state are handled by CSS ':disabled' pseudo-class
        }

        // Speak the current text
        function speakText(text) {
            // Basic implementation (same as before, ensure voices loaded)
            if (synth.speaking) { synth.cancel(); setTimeout(() => speakText(text), 100); return; }
            if (text === '') return;

            let voices = synth.getVoices();
            let kannadaVoice = voices.find(voice => voice.lang === 'kn-IN') || voices.find(voice => voice.lang.startsWith('kn')) || voices.find(voice => voice.lang === 'hi-IN') || voices.find(voice => voice.default);

            if (!kannadaVoice) { showMessage("‡≤Ø‡≤æ‡≤µ‡≥Å‡≤¶‡≥á ‡≤∏‡≥Ç‡≤ï‡≥ç‡≤§ ‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤≤‡≤≠‡≥ç‡≤Ø‡≤µ‡≤ø‡≤≤‡≥ç‡≤≤.", 'error'); return; }

            const utterThis = new SpeechSynthesisUtterance(text);
            utterThis.voice = kannadaVoice;
            utterThis.lang = kannadaVoice.lang;
            utterThis.pitch = 1;
            utterThis.rate = 0.85;

            utterThis.onstart = () => { speakButton.disabled = true; };
            utterThis.onend = () => { speakButton.disabled = false; };
            utterThis.onerror = (event) => {
                console.error('SpeechSynthesis Error:', event);
                showMessage(`‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤¶‡≥ã‡≤∑: ${event.error}`, 'error');
                speakButton.disabled = false;
            };
            synth.speak(utterThis);
        }

        // Show messages (info or error)
        function showMessage(message, type = 'info') { // type can be 'info' or 'error'
            messageBoxText.textContent = message;
            if (type === 'error') {
                messageBox.className = 'mt-5 message-error';
                messageBoxIcon.className = 'fas fa-exclamation-circle';
            } else {
                messageBox.className = 'mt-5 message-info';
                messageBoxIcon.className = 'fas fa-info-circle';
            }
        }

        // Update the validation feedback area
        function updateValidationUI(status, message) {
            recognizedTextSpan.textContent = message;
            switch (status) {
                case 'correct':
                    recognizedTextElement.className = 'mt-3 validation-correct';
                    recognizedTextIcon.className = 'fas fa-check-circle';
                    break;
                case 'incorrect':
                    recognizedTextElement.className = 'mt-3 validation-incorrect';
                    recognizedTextIcon.className = 'fas fa-times-circle';
                    break;
                case 'listening':
                    recognizedTextElement.className = 'mt-3 validation-listening';
                    recognizedTextIcon.className = 'fas fa-microphone-alt animate-pulse'; // Pulse icon while listening
                    break;
                case 'processing':
                     recognizedTextElement.className = 'mt-3 validation-listening'; // Use listening style for processing
                     recognizedTextIcon.className = 'fas fa-spinner fa-spin'; // Spinning icon
                     break;
                default: // 'default' or error
                    recognizedTextElement.className = 'mt-3 validation-default';
                    recognizedTextIcon.className = 'fas fa-comment-dots';
            }
        }

        // Reset validation UI to default state
        function resetValidationUI() {
             updateValidationUI('default', '‡≤®‡≥Ä‡≤µ‡≥Å ‡≤π‡≥á‡≤≥‡≤ø‡≤¶‡≥ç‡≤¶‡≥Å ‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤ï‡≤æ‡≤£‡≤ø‡≤∏‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü');
        }


         // Initialize Speech Recognition
        function initializeSpeechRecognition() {
            window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!window.SpeechRecognition) {
                showMessage("‡≤ï‡≥ç‡≤∑‡≤Æ‡≤ø‡≤∏‡≤ø, ‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤ó‡≥Å‡≤∞‡≥Å‡≤§‡≤ø‡≤∏‡≥Å‡≤µ‡≤ø‡≤ï‡≥Ü ‡≤¨‡≥Ü‡≤Ç‡≤¨‡≤≤‡≤ø‡≤∏‡≥Å‡≤µ‡≥Å‡≤¶‡≤ø‡≤≤‡≥ç‡≤≤.", 'error');
                recordButton.disabled = true;
                return;
            }

            recognition = new SpeechRecognition();
            recognition.lang = 'kn-IN';
            recognition.interimResults = false; // Final results only
            recognition.maxAlternatives = 1;

            recognition.onstart = () => {
                isRecording = true;
                recordButton.classList.add('recording');
                recordButton.innerHTML = `<i class="fas fa-stop-circle"></i> ‡≤®‡≤ø‡≤≤‡≥ç‡≤≤‡≤ø‡≤∏‡≤ø`; // Change to Stop icon
                updateValidationUI('listening', '‡≤ï‡≥á‡≤≥‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü...');
            };

            recognition.onresult = (event) => {
                updateValidationUI('processing', '‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü...'); // Show processing state
                const speechResult = event.results[0][0].transcript.trim();
                const confidence = event.results[0][0].confidence;
                console.log(`Recognition: "${speechResult}" (Confidence: ${confidence.toFixed(2)})`);

                // --- Validation Logic ---
                const currentTargetText = courseContent[currentContentIndex].text;
                // Normalize: remove punctuation, extra spaces, convert to lower case (optional but can help)
                const normalize = (str) => str.replace(/[.,!?]/g, '').replace(/\s+/g, ' ').trim().toLowerCase();

                // Use a short delay before showing result for better UX
                setTimeout(() => {
                    if (normalize(speechResult) === normalize(currentTargetText)) {
                        isCurrentItemCorrect = true; // Validation successful!
                        updateValidationUI('correct', `‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü! "${speechResult}"`);
                        updateNavButtons(); // Enable Next button
                        showMessage("‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü! '‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å' ‡≤í‡≤§‡≥ç‡≤§‡≤ø‡≤∞‡≤ø.", 'info');
                    } else {
                        isCurrentItemCorrect = false; // Validation failed
                        updateValidationUI('incorrect', `‡≤Æ‡≤§‡≥ç‡≤§‡≥Ü ‡≤™‡≥ç‡≤∞‡≤Ø‡≤§‡≥ç‡≤®‡≤ø‡≤∏‡≤ø. ‡≤ï‡≥á‡≤≥‡≤ø‡≤∏‡≤ø‡≤¶‡≥ç‡≤¶‡≥Å: "${speechResult}"`);
                        // Keep Next button disabled (updateNavButtons() not needed here as isCurrentItemCorrect is false)
                        showMessage(`‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤¶‡≤¶‡≥ç‡≤¶‡≥Å: "${currentTargetText}". ‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≤§‡≥ç‡≤§‡≥Ü '‡≤π‡≥á‡≤≥‡≤ø' ‡≤¨‡≤ü‡≤®‡≥ç ‡≤í‡≤§‡≥ç‡≤§‡≤ø‡≤∞‡≤ø.`, 'error');
                    }
                }, 300); // 300ms delay
            };

            recognition.onspeechend = () => {
                // Speech ended, but recognition might still be processing.
                // We stop the recording UI slightly later in onend or onerror.
                 if (isRecording) {
                     updateValidationUI('processing', '‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü...');
                 }
            };

            recognition.onnomatch = () => {
                 updateValidationUI('incorrect', "‡≤∏‡≥ç‡≤™‡≤∑‡≥ç‡≤ü‡≤µ‡≤æ‡≤ó‡≤ø ‡≤ï‡≥á‡≤≥‡≤ø‡≤∏‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤.");
                 showMessage("‡≤ï‡≥ç‡≤∑‡≤Æ‡≤ø‡≤∏‡≤ø, ‡≤®‡≤®‡≤ó‡≥Ü ‡≤Ö‡≤∞‡≥ç‡≤•‡≤µ‡≤æ‡≤ó‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤. ‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≤§‡≥ç‡≤§‡≥Ü ‡≤™‡≥ç‡≤∞‡≤Ø‡≤§‡≥ç‡≤®‡≤ø‡≤∏‡≤ø.", 'error');
                 stopRecording(); // Ensure UI reset
            };

            recognition.onerror = (event) => {
                console.error('SpeechRecognition error:', event.error);
                let errorMsg = "‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤¶‡≥ã‡≤∑: ";
                 switch (event.error) {
                    case 'no-speech': errorMsg += "‡≤Æ‡≤æ‡≤§‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø‡≤∏‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤."; break;
                    case 'audio-capture': errorMsg += "‡≤Æ‡≥à‡≤ï‡≥ç‡≤∞‡≥ä‡≤´‡≥ã‡≤®‡≥ç ‡≤∏‡≤Æ‡≤∏‡≥ç‡≤Ø‡≥Ü."; break;
                    case 'not-allowed': errorMsg += "‡≤Æ‡≥à‡≤ï‡≥ç‡≤∞‡≥ä‡≤´‡≥ã‡≤®‡≥ç ‡≤Ö‡≤®‡≥Å‡≤Æ‡≤§‡≤ø ‡≤¨‡≥á‡≤ï‡≥Å."; break;
                    default: errorMsg += event.error;
                }
                updateValidationUI('default', `‡≤¶‡≥ã‡≤∑: ${event.error}`); // Show error in validation area too
                showMessage(errorMsg, 'error');
                stopRecording(); // Ensure UI reset
            };

            recognition.onend = () => {
                 // Called after result, error, or stop()
                 stopRecording(); // Ensure UI is always reset cleanly
            };
        }

        // Start recording
        function startRecording() {
             if (!recognition || isRecording) return;
             if (synth.speaking) { synth.cancel(); } // Stop speech synthesis if active

             // Check/Request microphone permission before starting
             navigator.mediaDevices.getUserMedia({ audio: true })
                .then(stream => {
                     stream.getTracks().forEach(track => track.stop()); // Got permission, stop the track.
                     try {
                         recognition.start(); // Start the actual recognition
                     } catch (e) {
                         console.error("Error starting recognition:", e);
                         showMessage("‡≤∞‡≥Ü‡≤ï‡≤æ‡≤∞‡≥ç‡≤°‡≤ø‡≤Ç‡≤ó‡≥ç ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠‡≤ø‡≤∏‡≤≤‡≥Å ‡≤∏‡≤æ‡≤ß‡≥ç‡≤Ø‡≤µ‡≤æ‡≤ó‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤.", 'error');
                         stopRecording();
                     }
                })
                .catch(err => {
                    console.error("Mic permission error:", err);
                    showMessage("‡≤Æ‡≥à‡≤ï‡≥ç‡≤∞‡≥ä‡≤´‡≥ã‡≤®‡≥ç ‡≤Ö‡≤®‡≥Å‡≤Æ‡≤§‡≤ø ‡≤Ö‡≤ó‡≤§‡≥ç‡≤Ø‡≤µ‡≤ø‡≤¶‡≥Ü.", 'error');
                    updateValidationUI('default', '‡≤Æ‡≥à‡≤ï‡≥ç ‡≤Ö‡≤®‡≥Å‡≤Æ‡≤§‡≤ø ‡≤®‡≥Ä‡≤°‡≤ø‡≤≤‡≥ç‡≤≤');
                    stopRecording(); // Ensure UI is reset
                });
        }

        // Stop recording and reset UI
         function stopRecording() {
            if (recognition && isRecording) {
                 recognition.stop(); // Stop the engine
            }
            isRecording = false;
            recordButton.classList.remove('recording');
            recordButton.innerHTML = `<i class="fas fa-microphone"></i> ‡≤π‡≥á‡≤≥‡≤ø`; // Reset button
            // Don't reset validation UI here, it's handled by onresult/onerror/onnomatch
            // Only reset if it was stuck in 'listening' or 'processing' without a result/error
             const currentStatus = recognizedTextElement.className;
             if (currentStatus.includes('validation-listening') || currentStatus.includes('fa-spinner')) {
                 resetValidationUI();
             }
        }

        // --- Event Listeners ---
        prevButton.addEventListener('click', () => {
            if (currentContentIndex > 0) {
                currentContentIndex--;
                if (synth.speaking) synth.cancel();
                if (isRecording) stopRecording();
                updateDisplay();
            }
        });

        nextButton.addEventListener('click', () => {
            // Should only be clickable if isCurrentItemCorrect is true (enforced by disabled state)
            if (currentContentIndex < courseContent.length - 1) {
                currentContentIndex++;
                 if (synth.speaking) synth.cancel();
                 if (isRecording) stopRecording();
                updateDisplay();
            } else {
                // Optional: Handle course completion
                showMessage("‡≤Ö‡≤≠‡≤ø‡≤®‡≤Ç‡≤¶‡≤®‡≥Ü‡≤ó‡≤≥‡≥Å! ‡≤®‡≥Ä‡≤µ‡≥Å ‡≤é‡≤≤‡≥ç‡≤≤‡≤æ ‡≤™‡≤æ‡≤†‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤™‡≥Ç‡≤∞‡≥ç‡≤£‡≤ó‡≥ä‡≤≥‡≤ø‡≤∏‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ä‡≤∞‡≤ø!", 'info');
                displayArea.textContent = "üéâ"; // Celebration!
                progressBar.style.backgroundColor = '#48bb78'; // Green progress bar
            }
        });

        speakButton.addEventListener('click', () => {
            if (isRecording) stopRecording(); // Stop recording if user wants to listen
            const textToSpeak = courseContent[currentContentIndex]?.text;
            if (textToSpeak) speakText(textToSpeak);
        });

         recordButton.addEventListener('click', () => {
            if (isRecording) {
                stopRecording();
            } else {
                // Reset validation UI before starting a new attempt
                resetValidationUI();
                startRecording();
            }
        });

        // --- Initialization ---
        function initializeApp() {
             console.log("Initializing app...");
             prepareCourseContent(); // Prepare and shuffle content

             if (courseContent.length === 0) {
                 showMessage("‡≤Ø‡≤æ‡≤µ‡≥Å‡≤¶‡≥á ‡≤™‡≤æ‡≤†‡≤¶ ‡≤µ‡≤ø‡≤∑‡≤Ø ‡≤ï‡≤Ç‡≤°‡≥Å‡≤¨‡≤Ç‡≤¶‡≤ø‡≤≤‡≥ç‡≤≤!", 'error');
                 // Disable all buttons if no content
                 [prevButton, nextButton, speakButton, recordButton].forEach(btn => btn.disabled = true);
                 return;
             }

             initializeSpeechRecognition(); // Setup speech recognition
             updateDisplay(); // Show the first item and initial state
             console.log("App initialized.");
        }

        // Wait for voices to load before initializing
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = initializeApp;
            // Check if voices already loaded
             if (speechSynthesis.getVoices().length > 0) {
                 console.log("Voices already available.");
                 setTimeout(initializeApp, 50); // Short delay just in case
             } else {
                  console.log("Waiting for voiceschanged event...");
             }
        } else {
             console.warn("onvoiceschanged not supported. Using timeout.");
             setTimeout(initializeApp, 500); // Fallback timeout
        }

    </script>

</body>
</html>
