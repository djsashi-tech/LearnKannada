<!DOCTYPE html>
<html lang="kn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡≤ï‡≤®‡≥ç‡≤®‡≤° ‡≤ï‡≤≤‡≤ø‡≤Ø‡≥ã‡≤£ - ‡≤Ü‡≤ü‡≤¶‡≥ä‡≤Ç‡≤¶‡≤ø‡≤ó‡≥Ü ‡≤ï‡≤≤‡≤ø‡≤Ø‡≤ø‡≤∞‡≤ø</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Kannada:wght@400;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Base Styles & Fonts */
        body {
            font-family: 'Poppins', 'Noto Sans Kannada', sans-serif;
            user-select: none; -webkit-user-select: none; touch-action: manipulation;

            /* --- Background Image --- */
            /* Replace 'YOUR_IMAGE_URL_HERE.jpg' with the actual URL */
            background-image: url('YOUR_IMAGE_URL_HERE.jpg');
            background-size: cover; /* Cover the entire viewport */
            background-position: center center; /* Center the image */
            background-repeat: no-repeat; /* Do not repeat the image */
            background-attachment: fixed; /* Keep background fixed during scroll */
            /* Fallback color if image fails */
            background-color: #667eea;

            min-height: 100vh; padding: 1rem;
            position: relative; /* Needed for absolute positioning of menu */
        }
        /* Add a semi-transparent overlay to improve text readability over the image */
        body::before {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(255, 255, 255, 0.1); /* Light overlay */
            z-index: -1; /* Place behind content */
        }

        button { min-height: 48px; min-width: 48px; }
        .hidden { display: none; }

        /* Hamburger Menu Button */
        #menuButton {
            position: absolute; top: 1.5rem; left: 1.5rem; z-index: 100;
            background-color: rgba(255, 255, 255, 0.85); /* Slightly less transparent */
            backdrop-filter: blur(5px); color: #4a5568; border: 1px solid rgba(0,0,0,0.1);
            border-radius: 50%; width: 50px; height: 50px; display: flex;
            align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            cursor: pointer; transition: all 0.3s ease;
        }
        #menuButton:hover { background-color: rgba(255, 255, 255, 1); box-shadow: 0 6px 12px rgba(0,0,0,0.15); transform: scale(1.05); }
        #menuButton i { font-size: 1.5rem; }

        /* Menu Panel */
        #menuPanel {
            position: fixed; top: 0; left: -300px; width: 280px; height: 100%;
            background-color: rgba(255, 255, 255, 0.98); backdrop-filter: blur(15px);
            box-shadow: 5px 0px 15px rgba(0, 0, 0, 0.2); z-index: 150;
            transition: left 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); padding-top: 6rem;
            border-right: 1px solid rgba(0,0,0,0.1);
        }
        #menuPanel.open { left: 0; }

        /* Close Menu Button */
        #closeMenuButton { position: absolute; top: 1.5rem; right: 1.5rem; background: none; border: none; color: #6b7280; font-size: 2rem; cursor: pointer; transition: color 0.3s; }
        #closeMenuButton:hover { color: #1f2937; }

        /* Menu Items */
        #menuPanel a { display: block; padding: 1rem 1.5rem; font-size: 1.1rem; font-weight: 600; color: #374151; text-decoration: none; border-bottom: 1px solid #e5e7eb; transition: background-color 0.3s, color 0.3s; display: flex; align-items: center; gap: 0.8rem; }
        #menuPanel a:hover { background-color: #f3f4f6; color: #1e40af; }
        #menuPanel a i { color: #60a5fa; width: 20px; text-align: center; }
        #menuPanel a.active { background-color: #dbeafe; color: #1e3a8a; font-weight: 700; border-left: 4px solid #3b82f6; }
        #menuPanel a.active i { color: #2563eb; }

        /* Main Container Styling - Slightly less transparent for readability over image */
        #appContainer, #testSelectionArea, #testResultsArea {
             background-color: rgba(255, 255, 255, 0.97); /* More opaque */
             backdrop-filter: blur(8px); /* Adjust blur */
             border-radius: 1.5rem; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15), 0 6px 10px rgba(0, 0, 0, 0.1);
             border: 1px solid rgba(255, 255, 255, 0.3); padding: 1.5rem 2rem; margin-top: 1rem;
             width: 100%; max-width: 42rem; margin-left: auto; margin-right: auto;
        }

        /* Main Display Area - Enhanced */
        #displayArea { font-family: 'Noto Sans Kannada', sans-serif; font-size: clamp(3.5rem, 16vw, 9rem); line-height: 1.3; font-weight: 700; text-align: center; min-height: 280px; display: flex; align-items: center; justify-content: center; cursor: default; background: linear-gradient(145deg, #ffffff, #f7fafc); border-radius: 1.5rem; border: 1px solid #e2e8f0; color: #2d3748; margin-bottom: 2rem; padding: 2rem; box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08); transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease; }
        .correct-answer-flash { animation: flash-success 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
        @keyframes flash-success { 0% { transform: scale(1); box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08); } 50% { transform: scale(1.05); background: linear-gradient(135deg, #a8e063, #56ab2f); color: white; box-shadow: 0 12px 24px rgba(86, 171, 47, 0.3); border-color: transparent; } 100% { transform: scale(1); background: linear-gradient(145deg, #ffffff, #f7fafc); color: #2d3748; box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08); border-color: #e2e8f0; } }

        /* Message & Recognition Boxes - Enhanced */
        #messageBox, #recognizedText { min-height: 65px; font-size: 1.25rem; padding: 0.8rem 1.5rem; border-radius: 1rem; display: flex; align-items: center; justify-content: center; gap: 0.8rem; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 3px 6px rgba(0,0,0,0.05); border: 1px solid transparent; }
        #recognizedText i { font-size: 1.5em; margin-right: 0.2em; }

        /* Button Styles - Enhanced */
        .nav-button { font-family: 'Poppins', sans-serif; font-weight: 600; padding: 0.9rem 2rem; border-radius: 0.75rem; border: none; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 5px 12px rgba(0,0,0,0.12); display: inline-flex; align-items: center; gap: 0.7rem; text-shadow: none; }
        .nav-button i { font-size: 1.1em; }
        .nav-button:hover:not(:disabled) { box-shadow: 0 7px 15px rgba(0,0,0,0.18); transform: translateY(-2px); }
        .nav-button:active:not(:disabled) { transform: scale(0.95) translateY(0); box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
        .nav-button:disabled { background: #d1d5db !important; color: #9ca3af; cursor: not-allowed; opacity: 0.8; box-shadow: none; }
        #prevButton, #nextButton { background: linear-gradient(to right, #60a5fa, #3b82f6); color: white; }
        #prevButton:hover:not(:disabled), #nextButton:hover:not(:disabled) { background: linear-gradient(to right, #3b82f6, #2563eb); }
        .action-button { background: linear-gradient(to right, #4ade80, #22c55e); color: white; }
        .action-button:hover:not(:disabled) { background: linear-gradient(to right, #22c55e, #16a34a); }
        .record-button { background: linear-gradient(to right, #f87171, #ef4444); color: white; }
        .record-button:hover:not(:disabled) { background: linear-gradient(to right, #ef4444, #dc2626); }
        .record-button.recording { background: linear-gradient(to right, #fb923c, #f97316); animation: pulse 1.5s infinite; }

        /* Lesson Title & Score */
        #lessonTitle { font-size: 1.5rem; font-weight: 700; color: #4338ca; margin-bottom: 0.3rem; text-align: center; }
        #lessonScore { font-size: 1.1rem; font-weight: 500; color: #4b5563; text-align: center; margin-bottom: 0.8rem; min-height: 1.5rem; }

        /* Progress Bar & Hint Count Container */
        #progressHintContainer { display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
        #progressBarContainer { flex-grow: 1; background-color: #e5e7eb; border-radius: 9999px; overflow: hidden; height: 1.4rem; box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); }
        #progressBar { height: 100%; width: 0%; background: linear-gradient(to right, #34d399, #10b981); border-radius: 9999px; transition: width 0.5s ease-in-out; text-align: center; color: white; font-size: 0.85rem; line-height: 1.4rem; font-weight: 700; }
        #hintCounterDisplay { font-size: 1rem; font-weight: 600; color: #1d4ed8; background-color: #dbeafe; padding: 0.4rem 1rem; border-radius: 9999px; white-space: nowrap; border: 1px solid #93c5fd; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        #hintCounterDisplay i { margin-right: 0.4rem; color: #2563eb; }

        /* Validation Styles */
        .validation-correct { background-color: #d1fae5; color: #059669; border: 2px solid #6ee7b7; }
        .validation-incorrect { background-color: #fee2e2; color: #dc2626; border: 2px solid #fca5a5; }
        .validation-listening { background-color: #ffedd5; color: #ea580c; border: 2px solid #fdba74; }
        .validation-default { background-color: #f9fafb; color: #6b7280; border: 2px dashed #d1d5db; }
        .message-info { background-color: #e0f2fe; color: #0284c7; border: 1px solid #7dd3fc; }
        .message-error { background-color: #fef2f2; color: #dc2626; border: 1px solid #fca5a5; }
        .message-pass { background-color: #dcfce7; color: #16a34a; border: 1px solid #86efac; font-weight: bold; }
        .message-fail { background-color: #fef2f2; color: #dc2626; border: 1px solid #fca5a5; font-weight: bold; }

        /* Test Selection Area */
        #testSelectionArea { margin-bottom: 1.5rem; text-align: center; background-color: rgba(255, 255, 255, 0.97); padding: 1.5rem; border-radius: 1.5rem; box-shadow: 0 6px 12px rgba(0,0,0,0.1); }
        .test-select-button { background: linear-gradient(to right, #a5b4fc, #818cf8); color: white; margin: 0.4rem; padding: 0.7rem 1.4rem; border-radius: 0.75rem; cursor: pointer; transition: all 0.3s; font-weight: 600; border: none; box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
        .test-select-button:hover { background: linear-gradient(to right, #818cf8, #6366f1); transform: translateY(-2px); box-shadow: 0 5px 10px rgba(0,0,0,0.15); }
        .test-select-button.active { background: linear-gradient(to right, #34d399, #10b981); transform: translateY(-2px); box-shadow: 0 5px 10px rgba(16, 185, 129, 0.3); }

        /* Test Results Area */
         #testResultsArea { background-color: rgba(255, 255, 255, 0.97); }
         #testResultStatus.text-green-600 { color: #16a34a; }
         #testResultStatus.text-red-600 { color: #dc2626; }

    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <button id="menuButton" onclick="toggleMenu()">
        <i class="fas fa-bars"></i>
    </button>

    <div id="menuPanel">
        <button id="closeMenuButton" onclick="toggleMenu()">
            <i class="fas fa-times"></i>
        </button>
        <a href="#" id="menuLearn" class="active" onclick="selectModeFromMenu('learn')">
            <i class="fas fa-graduation-cap"></i> ‡≤Ö‡≤≠‡≥ç‡≤Ø‡≤æ‡≤∏ (Learn)
        </a>
        <a href="#" id="menuTest" onclick="selectModeFromMenu('test')">
            <i class="fas fa-clipboard-check"></i> ‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≥Ü (Test)
        </a>
        </div>

     <div id="testSelectionArea" class="hidden w-full max-w-3xl mx-auto">
        <h2 class="text-xl font-bold mb-4 text-indigo-800">‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≥Ü‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø (Select Test)</h2>
        </div>


    <div id="appContainer" class="w-full max-w-3xl mx-auto">
        <div id="progressHintContainer">
            <div id="progressBarContainer" title="‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤™‡≥ç‡≤∞‡≤ó‡≤§‡≤ø (Your Progress)">
                <div id="progressBar"></div>
            </div>
            <div id="hintCounterDisplay" title="‡≤ï‡≥á‡≤≥‡≤ø‡≤¶ ‡≤∏‡≥Å‡≤≥‡≤ø‡≤µ‡≥Å‡≤ó‡≤≥ ‡≤∏‡≤Ç‡≤ñ‡≥ç‡≤Ø‡≥Ü (Number of hints used)">
                <i class="fas fa-headphones-alt"></i> <span id="hintCount">0</span>
            </div>
        </div>

        <div id="lessonTitle">‡≤™‡≤æ‡≤†‡≤¶ ‡≤∂‡≥Ä‡≤∞‡≥ç‡≤∑‡≤ø‡≤ï‡≥Ü</div>
        <div id="lessonScore">‡≤™‡≤æ‡≤†‡≤¶ ‡≤∏‡≥ç‡≤ï‡≥ã‡≤∞‡≥ç</div>
        <p id="instructionText" class="text-center text-gray-700 mb-5 text-base font-medium">‡≤ï‡≥Ü‡≤≥‡≤ó‡≤ø‡≤®‡≤¶‡≤®‡≥ç‡≤®‡≥Å ‡≤ì‡≤¶‡≤ø ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å '‡≤π‡≥á‡≤≥‡≤ø' ‡≤¨‡≤ü‡≤®‡≥ç ‡≤í‡≤§‡≥ç‡≤§‡≤ø‡≤∞‡≤ø</p>

        <div id="displayArea">
             </div>

        <div class="flex justify-between mt-6 mb-6">
            <button id="prevButton" class="nav-button" title="‡≤π‡≤ø‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å (Previous)">
                <i class="fas fa-chevron-left"></i> ‡≤π‡≤ø‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å
            </button>
            <button id="nextButton" class="nav-button" title="‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å (Next)">
                ‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mt-5">
            <button id="speakButton" class="nav-button action-button w-full sm:w-auto" title="‡≤ï‡≥á‡≤≥‡≤ø (Listen)">
                <i class="fas fa-volume-high"></i> ‡≤ï‡≥á‡≤≥‡≤ø
            </button>
            <button id="recordButton" class="nav-button record-button w-full sm:w-auto" title="‡≤π‡≥á‡≤≥‡≤ø (Speak)">
                 <i class="fas fa-microphone-lines"></i> ‡≤π‡≥á‡≤≥‡≤ø
            </button>
        </div>

        <div id="messageBox" class="mt-6 message-info">
             <i class="fas fa-info-circle"></i> <span>‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠‡≤ø‡≤∏‡≤≤‡≥Å ‡≤∏‡≤ø‡≤¶‡≥ç‡≤ß!</span>
        </div>
         <div id="recognizedText" class="mt-4 validation-default">
             <i class="fas fa-comment-dots"></i> <span>‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤∏‡≤∞‡≤¶‡≤ø (Your turn)</span>
        </div>
    </div>

     <div id="testResultsArea" class="hidden w-full max-w-3xl mx-auto">
         <h2 class="text-2xl font-bold mb-5 text-indigo-800">‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≥Ü‡≤Ø ‡≤´‡≤≤‡≤ø‡≤§‡≤æ‡≤Ç‡≤∂ (Test Result)</h2>
         <p id="testResultScore" class="text-xl mb-3 font-medium text-gray-800"></p>
         <p id="testResultStatus" class="text-3xl font-bold mb-6"></p>
         <button onclick="restartApp()" class="nav-button action-button text-lg px-8 py-3">
             <i class="fas fa-redo-alt"></i> ‡≤Æ‡≤§‡≥ç‡≤§‡≥Ü ‡≤™‡≥ç‡≤∞‡≤Ø‡≤§‡≥ç‡≤®‡≤ø‡≤∏‡≤ø (Retry)
         </button>
     </div>


    <script>
        // --- Constants ---
        const TEST_SIZE = 50;
        const TEST_PASS_THRESHOLD = 35;

        // --- Configuration & Content ---
        function shuffleArray(array) { /* Fisher-Yates shuffle... */ for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } return array; }
        const lessons = [ /* Lesson data... */
             { title: "‡≤™‡≤æ‡≤† 1: ‡≤∏‡≤∞‡≤≥ ‡≤™‡≤¶‡≤ó‡≤≥‡≥Å", shuffle: true, content: [ "‡≤Æ‡≤®‡≥Ü", "‡≤®‡≥Ä‡≤∞‡≥Å", "‡≤ä‡≤ü", "‡≤ï‡≥Ü‡≤≤‡≤∏", "‡≤¨‡≤æ", "‡≤π‡≥ã‡≤ó‡≥Å", "‡≤ì‡≤¶‡≥Å", "‡≤®‡≥ã‡≤°‡≥Å", "‡≤á‡≤¶‡≥Å", "‡≤Ö‡≤¶‡≥Å", "‡≤π‡≤£‡≥ç‡≤£‡≥Å", "‡≤π‡≥Ç‡≤µ‡≥Å", "‡≤Æ‡≤∞", "‡≤ó‡≤ø‡≤°", "‡≤¨‡≥Ä‡≤¶‡≤ø", "‡≤¶‡≤æ‡≤∞", "‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü", "‡≤ö‡≤π‡≤æ", "‡≤ï‡≤æ‡≤´‡≤ø", "‡≤π‡≤æ‡≤≤‡≥Å", "‡≤Æ‡≥ä‡≤∏‡≤∞‡≥Å", "‡≤Ö‡≤ï‡≥ç‡≤ï‡≤ø", "‡≤¨‡≥á‡≤≥‡≥Ü", "‡≤§‡≤∞‡≤ï‡≤æ‡≤∞‡≤ø", "‡≤ó‡≤æ‡≤≥‡≤ø", "‡≤¨‡≥Ü‡≤≥‡≤ï‡≥Å", "‡≤∏‡≥Ç‡≤∞‡≥ç‡≤Ø", "‡≤ö‡≤Ç‡≤¶‡≥ç‡≤∞", "‡≤¶‡≤ø‡≤®", "‡≤∞‡≤æ‡≤§‡≥ç‡≤∞‡≤ø", "‡≤¨‡≥Ü‡≤≥‡≤ø‡≤ó‡≥ç‡≤ó‡≥Ü", "‡≤∏‡≤Ç‡≤ú‡≥Ü", "‡≤Æ‡≤ß‡≥ç‡≤Ø‡≤æ‡≤π‡≥ç‡≤®", "‡≤π‡≤£", "‡≤Ö‡≤Ç‡≤ó‡≤°‡≤ø", "‡≤¶‡≤æ‡≤∞‡≤ø", "‡≤ä‡≤∞‡≥Å", "‡≤¶‡≥á‡≤∂", "‡≤∂‡≤æ‡≤≤‡≥Ü", "‡≤ï‡≤æ‡≤≤‡≥á‡≤ú‡≥Å", "‡≤Ü‡≤ü", "‡≤™‡≤æ‡≤†", "‡≤π‡≤æ‡≤°‡≥Å", "‡≤Æ‡≤æ‡≤§‡≥Å", "‡≤®‡≤ó‡≥Å", "‡≤Ö‡≤≥‡≥Å", "‡≤®‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ü", "‡≤é‡≤ö‡≥ç‡≤ö‡≤∞", "‡≤∏‡≥ç‡≤µ‡≤≤‡≥ç‡≤™", "‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ", "‡≤¶‡≥ä‡≤°‡≥ç‡≤°", "‡≤ö‡≤ø‡≤ï‡≥ç‡≤ï", "‡≤í‡≤≥‡≥ç‡≤≥‡≥Ü‡≤Ø", "‡≤ï‡≥Ü‡≤ü‡≥ç‡≤ü", "‡≤π‡≥ä‡≤∏", "‡≤π‡≤≥‡≥Ü‡≤Ø", "‡≤∏‡≥Å‡≤≤‡≤≠", "‡≤ï‡≤∑‡≥ç‡≤ü", "‡≤¨‡≥á‡≤ó", "‡≤®‡≤ø‡≤ß‡≤æ‡≤®", "‡≤á‡≤≤‡≥ç‡≤≤‡≤ø", "‡≤Ö‡≤≤‡≥ç‡≤≤‡≤ø", "‡≤π‡≤§‡≥ç‡≤§‡≤ø‡≤∞", "‡≤¶‡≥Ç‡≤∞", "‡≤Æ‡≥á‡≤≤‡≥Ü", "‡≤ï‡≥Ü‡≤≥‡≤ó‡≥Ü", "‡≤í‡≤≥‡≤ó‡≥Ü", "‡≤π‡≥ä‡≤∞‡≤ó‡≥Ü", "‡≤Æ‡≥Å‡≤Ç‡≤¶‡≥Ü", "‡≤π‡≤ø‡≤Ç‡≤¶‡≥Ü", "‡≤Ø‡≤æ‡≤∞‡≥Å", "‡≤è‡≤®‡≥Å", "‡≤Ø‡≤æ‡≤µ‡≤æ‡≤ó", "‡≤é‡≤≤‡≥ç‡≤≤‡≤ø", "‡≤π‡≥á‡≤ó‡≥Ü", "‡≤è‡≤ï‡≥Ü", "‡≤®‡≤æ‡≤®‡≥Å", "‡≤®‡≥Ä‡≤®‡≥Å", "‡≤Ö‡≤µ‡≤®‡≥Å", "‡≤Ö‡≤µ‡≤≥‡≥Å", "‡≤Ö‡≤¶‡≥Å", "‡≤®‡≤æ‡≤µ‡≥Å", "‡≤®‡≥Ä‡≤µ‡≥Å", "‡≤Ö‡≤µ‡≤∞‡≥Å", "‡≤á‡≤µ‡≤∞‡≥Å", "‡≤Ö‡≤Æ‡≥ç‡≤Æ", "‡≤Ö‡≤™‡≥ç‡≤™", "‡≤Ö‡≤£‡≥ç‡≤£", "‡≤§‡≤Æ‡≥ç‡≤Æ", "‡≤Ö‡≤ï‡≥ç‡≤ï", "‡≤§‡≤Ç‡≤ó‡≤ø", "‡≤ó‡≥Ü‡≤≥‡≥Ü‡≤Ø", "‡≤ó‡≥Ü‡≤≥‡≤§‡≤ø", "‡≤Æ‡≤ó‡≥Å", "‡≤¶‡≥á‡≤µ‡≤∞‡≥Å", "‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï", "‡≤™‡≥Ü‡≤®‡≥ç‡≤®‡≥Å", "‡≤¨‡≤£‡≥ç‡≤£", "‡≤∏‡≤∞‡≤ø", "‡≤§‡≤™‡≥ç‡≤™‡≥Å" ] },
             { title: "‡≤™‡≤æ‡≤† 2: ‡≤é‡≤∞‡≤°‡≥Å ‡≤™‡≤¶‡≤ó‡≤≥ ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å", shuffle: true, content: [ "‡≤á‡≤¶‡≥Å ‡≤Æ‡≤®‡≥Ü.", "‡≤®‡≥Ä‡≤∞‡≥Å ‡≤ï‡≥Å‡≤°‡≤ø.", "‡≤Æ‡≤®‡≥Ü‡≤ó‡≥Ü ‡≤¨‡≤æ.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤¨‡≤Ç‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤π‡≥ã‡≤¶‡≤≥‡≥Å.", "‡≤ï‡≥Ü‡≤≤‡≤∏ ‡≤Æ‡≤æ‡≤°‡≥Å.", "‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï ‡≤ì‡≤¶‡≥Å.", "‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤®‡≤ó‡≥Å.", "‡≤¨‡≥á‡≤ó ‡≤¨‡≤æ.", "‡≤®‡≤ø‡≤ß‡≤æ‡≤® ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤π‡≤£‡≥ç‡≤£‡≥Å ‡≤§‡≤ø‡≤®‡≥ç‡≤®‡≥Å.", "‡≤π‡≥Ç‡≤µ‡≥Å ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤Æ‡≤∞ ‡≤π‡≤§‡≥ç‡≤§‡≥Å.", "‡≤ó‡≤ø‡≤° ‡≤®‡≥Ü‡≤°‡≥Å.", "‡≤¨‡≥Ä‡≤¶‡≤ø ‡≤¶‡≤æ‡≤ü‡≥Å.", "‡≤¶‡≤æ‡≤∞ ‡≤π‡≤ø‡≤°‡≤ø.", "‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü ‡≤π‡≤æ‡≤ï‡≥Å.", "‡≤ö‡≤π‡≤æ ‡≤ï‡≥Å‡≤°‡≤ø.", "‡≤ï‡≤æ‡≤´‡≤ø ‡≤¨‡≥á‡≤°.", "‡≤π‡≤æ‡≤≤‡≥Å ‡≤ï‡≥ä‡≤°‡≥Å.", "‡≤Æ‡≥ä‡≤∏‡≤∞‡≥Å ‡≤¨‡≥á‡≤ï‡≥Å.", "‡≤Ö‡≤ï‡≥ç‡≤ï‡≤ø ‡≤§‡≥ä‡≤≥‡≤ø.", "‡≤¨‡≥á‡≤≥‡≥Ü ‡≤¨‡≥á‡≤Ø‡≤ø‡≤∏‡≥Å.", "‡≤§‡≤∞‡≤ï‡≤æ‡≤∞‡≤ø ‡≤ï‡≤§‡≥ç‡≤§‡≤∞‡≤ø‡≤∏‡≥Å.", "‡≤ó‡≤æ‡≤≥‡≤ø ‡≤¨‡≥Ä‡≤∏‡≤ø‡≤§‡≥Å.", "‡≤¨‡≥Ü‡≤≥‡≤ï‡≥Å ‡≤¨‡≤Ç‡≤§‡≥Å.", "‡≤∏‡≥Ç‡≤∞‡≥ç‡≤Ø ‡≤Æ‡≥Ç‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤ö‡≤Ç‡≤¶‡≥ç‡≤∞ ‡≤ï‡≤æ‡≤£‡≤ø‡≤∏‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤¶‡≤ø‡≤® ‡≤ï‡≤≥‡≥Ü‡≤Ø‡≤ø‡≤§‡≥Å.", "‡≤∞‡≤æ‡≤§‡≥ç‡≤∞‡≤ø ‡≤Ü‡≤Ø‡≤ø‡≤§‡≥Å.", "‡≤¨‡≥Ü‡≤≥‡≤ø‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤è‡≤≥‡≥Å.", "‡≤∏‡≤Ç‡≤ú‡≥Ü ‡≤¨‡≤æ.", "‡≤Æ‡≤ß‡≥ç‡≤Ø‡≤æ‡≤π‡≥ç‡≤® ‡≤ä‡≤ü.", "‡≤π‡≤£ ‡≤ï‡≥ä‡≤°‡≥Å.", "‡≤Ö‡≤Ç‡≤ó‡≤°‡≤ø ‡≤§‡≥Ü‡≤∞‡≥Ü‡≤¶‡≤ø‡≤¶‡≥Ü.", "‡≤¶‡≤æ‡≤∞‡≤ø ‡≤§‡≥ã‡≤∞‡≤ø‡≤∏‡≥Å.", "‡≤ä‡≤∞‡≥Å ‡≤§‡≤≤‡≥Å‡≤™‡≤ø‡≤¶‡≥Ü.", "‡≤¶‡≥á‡≤∂ ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", "‡≤∂‡≤æ‡≤≤‡≥Ü ‡≤Æ‡≥Å‡≤ó‡≤ø‡≤Ø‡≤ø‡≤§‡≥Å.", "‡≤ï‡≤æ‡≤≤‡≥á‡≤ú‡≥Å ‡≤Ü‡≤∞‡≤Ç‡≤≠.", "‡≤Ü‡≤ü ‡≤Ü‡≤°‡≥Å.", "‡≤™‡≤æ‡≤† ‡≤ï‡≤≤‡≤ø.", "‡≤π‡≤æ‡≤°‡≥Å ‡≤π‡≥á‡≤≥‡≥Å.", "‡≤Æ‡≤æ‡≤§‡≥Å ‡≤ï‡≥á‡≤≥‡≥Å.", "‡≤®‡≤ó‡≥Å ‡≤®‡≤ø‡≤≤‡≥ç‡≤≤‡≤ø‡≤∏‡≥Å.", "‡≤Ö‡≤≥‡≥Å ‡≤®‡≤ø‡≤≤‡≥ç‡≤≤‡≤ø‡≤∏‡≥Å.", "‡≤®‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ü ‡≤Æ‡≤æ‡≤°‡≥Å.", "‡≤é‡≤ö‡≥ç‡≤ö‡≤∞ ‡≤á‡≤∞‡≥Å.", "‡≤∏‡≥ç‡≤µ‡≤≤‡≥ç‡≤™ ‡≤ï‡≥ä‡≤°‡≥Å.", "‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤§‡≤ø‡≤®‡≥ç‡≤®‡≥Å.", "‡≤¶‡≥ä‡≤°‡≥ç‡≤° ‡≤Æ‡≤®‡≥Ü.", "‡≤ö‡≤ø‡≤ï‡≥ç‡≤ï ‡≤Æ‡≤ó‡≥Å.", "‡≤í‡≤≥‡≥ç‡≤≥‡≥Ü‡≤Ø ‡≤π‡≥Å‡≤°‡≥Å‡≤ó.", "‡≤ï‡≥Ü‡≤ü‡≥ç‡≤ü ‡≤ï‡≤®‡≤∏‡≥Å.", "‡≤π‡≥ä‡≤∏ ‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü.", "‡≤π‡≤≥‡≥Ü‡≤Ø ‡≤®‡≥Ü‡≤®‡≤™‡≥Å.", "‡≤∏‡≥Å‡≤≤‡≤≠ ‡≤™‡≥ç‡≤∞‡≤∂‡≥ç‡≤®‡≥Ü.", "‡≤ï‡≤∑‡≥ç‡≤ü ‡≤ï‡≥Ü‡≤≤‡≤∏.", "‡≤¨‡≥á‡≤ó ‡≤¨‡≤æ.", "‡≤®‡≤ø‡≤ß‡≤æ‡≤® ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤á‡≤°‡≥Å.", "‡≤Ö‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤π‡≤§‡≥ç‡≤§‡≤ø‡≤∞ ‡≤¨‡≤æ.", "‡≤¶‡≥Ç‡≤∞ ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Æ‡≥á‡≤≤‡≥Ü ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤ï‡≥Ü‡≤≥‡≤ó‡≥Ü ‡≤á‡≤≥‡≤ø‡≤∏‡≥Å.", "‡≤í‡≤≥‡≤ó‡≥Ü ‡≤¨‡≤æ.", "‡≤π‡≥ä‡≤∞‡≤ó‡≥Ü ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Æ‡≥Å‡≤Ç‡≤¶‡≥Ü ‡≤∏‡≤∞‡≤ø.", "‡≤π‡≤ø‡≤Ç‡≤¶‡≥Ü ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤Ø‡≤æ‡≤∞‡≥Å ‡≤¨‡≤Ç‡≤¶‡≤∞‡≥Å?", "‡≤è‡≤®‡≥Å ‡≤¨‡≥á‡≤ï‡≥Å?", "‡≤Ø‡≤æ‡≤µ‡≤æ‡≤ó ‡≤¨‡≤∞‡≥Å‡≤µ‡≥Ü?", "‡≤é‡≤≤‡≥ç‡≤≤‡≤ø ‡≤π‡≥ã‡≤¶‡≥Ü?", "‡≤π‡≥á‡≤ó‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≥Ü?", "‡≤è‡≤ï‡≥Ü ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≥Ü?", "‡≤®‡≤æ‡≤®‡≥Å ‡≤¨‡≤Ç‡≤¶‡≥Ü.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤Ö‡≤¶‡≥Å ‡≤π‡≤æ‡≤∞‡≤ø‡≤§‡≥Å.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤ó‡≥Ü‡≤¶‡≥ç‡≤¶‡≥Ü‡≤µ‡≥Å.", "‡≤®‡≥Ä‡≤µ‡≥Å ‡≤∏‡≥ã‡≤§‡≤∞‡≥Å.", "‡≤Ö‡≤µ‡≤∞‡≥Å ‡≤¨‡≤Ç‡≤¶‡≤∞‡≥Å.", "‡≤á‡≤µ‡≤∞‡≥Å ‡≤Ø‡≤æ‡≤∞‡≥Å?", "‡≤Ö‡≤Æ‡≥ç‡≤Æ ‡≤ï‡≤∞‡≥Ü‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤™‡≥ç‡≤™ ‡≤π‡≥á‡≤≥‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤£‡≥ç‡≤£ ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤§‡≤Æ‡≥ç‡≤Æ ‡≤Ü‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤ï‡≥ç‡≤ï ‡≤ì‡≤¶‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤§‡≤Ç‡≤ó‡≤ø ‡≤Æ‡≤≤‡≤ó‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤ó‡≥Ü‡≤≥‡≥Ü‡≤Ø ‡≤¨‡≤Ç‡≤¶‡≤®‡≥Å.", "‡≤ó‡≥Ü‡≤≥‡≤§‡≤ø ‡≤π‡≥ã‡≤¶‡≤≥‡≥Å.", "‡≤Æ‡≤ó‡≥Å ‡≤Ö‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü.", "‡≤¶‡≥á‡≤µ‡≤∞‡≥Å ‡≤á‡≤¶‡≥ç‡≤¶‡≤æ‡≤®‡≥Ü.", "‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï ‡≤ï‡≥ä‡≤°‡≥Å.", "‡≤™‡≥Ü‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤ó‡≥ã.", "‡≤¨‡≤£‡≥ç‡≤£ ‡≤π‡≤ö‡≥ç‡≤ö‡≥Å.", "‡≤∏‡≤∞‡≤ø ‡≤π‡≥á‡≤≥‡≥Å.", "‡≤§‡≤™‡≥ç‡≤™‡≥Å ‡≤Æ‡≤æ‡≤°‡≤¨‡≥á‡≤°." ] },
             { title: "‡≤™‡≤æ‡≤† 3: ‡≤Æ‡≥Ç‡≤∞‡≥Å ‡≤™‡≤¶‡≤ó‡≤≥ ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å", shuffle: true, content: [ "‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤ï‡≥Å‡≤°‡≤ø‡≤¶‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤∂‡≤æ‡≤≤‡≥Ü‡≤ó‡≥Ü ‡≤π‡≥ã‡≤¶‡≤≥‡≥Å.", "‡≤á‡≤¶‡≥Å ‡≤¶‡≥ä‡≤°‡≥ç‡≤° ‡≤Æ‡≤®‡≥Ü.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤ì‡≤¶‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤®‡≥Ü.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü ‡≤¨‡≤∞‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤µ‡≥Ü.", "‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤¨‡≤æ.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤ï‡≥Ü‡≤≤‡≤∏ ‡≤Æ‡≤æ‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤®‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤π‡≤æ‡≤°‡≥Å ‡≤π‡≥á‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤≥‡≥Ü.", "‡≤Æ‡≤ó‡≥Å ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤®‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤Ü‡≤ü ‡≤Ü‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤µ‡≥Ü.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤π‡≤£‡≥ç‡≤£‡≥Å ‡≤§‡≤ø‡≤Ç‡≤¶‡≥Ü‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤π‡≥Ç‡≤µ‡≥Å ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤Æ‡≤∞ ‡≤π‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤ó‡≤ø‡≤° ‡≤®‡≥Ü‡≤ü‡≥ç‡≤ü‡≥Ü‡≤µ‡≥Å.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤¨‡≥Ä‡≤¶‡≤ø ‡≤¶‡≤æ‡≤ü‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤¶‡≤æ‡≤∞ ‡≤π‡≤ø‡≤°‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü ‡≤π‡≤æ‡≤ï‡≤ø‡≤¶‡≥Ü‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤ö‡≤π‡≤æ ‡≤ï‡≥Å‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≤ø‡≤ó‡≥Ü ‡≤ï‡≤æ‡≤´‡≤ø ‡≤¨‡≥á‡≤°.", "‡≤Ö‡≤Æ‡≥ç‡≤Æ ‡≤π‡≤æ‡≤≤‡≥Å ‡≤ï‡≥ä‡≤ü‡≥ç‡≤ü‡≤∞‡≥Å.", "‡≤®‡≤®‡≤ó‡≥Ü ‡≤Æ‡≥ä‡≤∏‡≤∞‡≥Å ‡≤¨‡≥á‡≤ï‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤Ö‡≤ï‡≥ç‡≤ï‡≤ø ‡≤§‡≥ä‡≤≥‡≥Ü‡≤¶‡≤≥‡≥Å.", "‡≤Ö‡≤™‡≥ç‡≤™ ‡≤¨‡≥á‡≤≥‡≥Ü ‡≤§‡≤Ç‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤Æ‡≥ç‡≤Æ ‡≤§‡≤∞‡≤ï‡≤æ‡≤∞‡≤ø ‡≤π‡≥Ü‡≤ö‡≥ç‡≤ö‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤§‡≤£‡≥ç‡≤£‡≤®‡≥Ü ‡≤ó‡≤æ‡≤≥‡≤ø ‡≤¨‡≥Ä‡≤∏‡≤ø‡≤§‡≥Å.", "‡≤™‡≥ç‡≤∞‡≤ï‡≤æ‡≤∂‡≤Æ‡≤æ‡≤® ‡≤¨‡≥Ü‡≤≥‡≤ï‡≥Å ‡≤¨‡≤Ç‡≤§‡≥Å.", "‡≤∏‡≥Ç‡≤∞‡≥ç‡≤Ø ‡≤™‡≥Ç‡≤∞‡≥ç‡≤µ‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤Æ‡≥Ç‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤ö‡≤Ç‡≤¶‡≥ç‡≤∞ ‡≤Ü‡≤ï‡≤æ‡≤∂‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤ï‡≤æ‡≤£‡≤ø‡≤∏‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤¶‡≤ø‡≤® ‡≤¨‡≥á‡≤ó ‡≤ï‡≤≥‡≥Ü‡≤Ø‡≤ø‡≤§‡≥Å.", "‡≤∞‡≤æ‡≤§‡≥ç‡≤∞‡≤ø ‡≤®‡≤ø‡≤ß‡≤æ‡≤®‡≤µ‡≤æ‡≤ó‡≤ø ‡≤Ü‡≤Ø‡≤ø‡≤§‡≥Å.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤¨‡≥Ü‡≤≥‡≤ø‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤¨‡≥á‡≤ó ‡≤é‡≤¶‡≥ç‡≤¶‡≥Ü.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤∏‡≤Ç‡≤ú‡≥Ü ‡≤Æ‡≤®‡≥Ü‡≤ó‡≥Ü ‡≤¨‡≤æ.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤Æ‡≤ß‡≥ç‡≤Ø‡≤æ‡≤π‡≥ç‡≤® ‡≤ä‡≤ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≥Ü‡≤µ‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤®‡≤®‡≤ó‡≥Ü ‡≤π‡≤£ ‡≤ï‡≥ä‡≤ü‡≥ç‡≤ü‡≤®‡≥Å.", "‡≤Ö‡≤Ç‡≤ó‡≤°‡≤ø ‡≤à‡≤ó ‡≤§‡≥Ü‡≤∞‡≥Ü‡≤¶‡≤ø‡≤¶‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤¶‡≤æ‡≤∞‡≤ø ‡≤§‡≥ã‡≤∞‡≤ø‡≤∏‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤ä‡≤∞‡≥Å ‡≤§‡≤≤‡≥Å‡≤™‡≤ø‡≤¶‡≥Ü‡≤®‡≥Å.", "‡≤®‡≤Æ‡≥ç‡≤Æ ‡≤¶‡≥á‡≤∂ ‡≤∏‡≥Å‡≤Ç‡≤¶‡≤∞‡≤µ‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", "‡≤∂‡≤æ‡≤≤‡≥Ü ‡≤®‡≤æ‡≤≥‡≥Ü ‡≤∞‡≤ú‡≥Ü.", "‡≤ï‡≤æ‡≤≤‡≥á‡≤ú‡≥Å ‡≤∏‡≥ã‡≤Æ‡≤µ‡≤æ‡≤∞ ‡≤Ü‡≤∞‡≤Ç‡≤≠.", "‡≤Æ‡≤ï‡≥ç‡≤ï‡≤≥‡≥Å ‡≤Ü‡≤ü ‡≤Ü‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤∞‡≥Ü.", "‡≤µ‡≤ø‡≤¶‡≥ç‡≤Ø‡≤æ‡≤∞‡≥ç‡≤•‡≤ø‡≤ó‡≤≥‡≥Å ‡≤™‡≤æ‡≤† ‡≤ï‡≤≤‡≤ø‡≤Ø‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤∞‡≥Ü.", "‡≤ó‡≤æ‡≤Ø‡≤ï‡≤ø ‡≤π‡≤æ‡≤°‡≥Å ‡≤π‡≥á‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤≥‡≥Ü.", "‡≤π‡≤ø‡≤∞‡≤ø‡≤Ø‡≤∞‡≥Å ‡≤Æ‡≤æ‡≤§‡≥Å ‡≤π‡≥á‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤∞‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤ú‡≥ã‡≤∞‡≤æ‡≤ó‡≤ø ‡≤®‡≤ï‡≥ç‡≤ï‡≤≥‡≥Å.", "‡≤Æ‡≤ó‡≥Å ‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤Ö‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤ó‡≤æ‡≤¢ ‡≤®‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤à‡≤ó ‡≤é‡≤ö‡≥ç‡≤ö‡≤∞‡≤µ‡≤æ‡≤¶‡≥Ü.", "‡≤®‡≤®‡≤ó‡≥Ü ‡≤∏‡≥ç‡≤µ‡≤≤‡≥ç‡≤™ ‡≤®‡≥Ä‡≤∞‡≥Å ‡≤ï‡≥ä‡≤°‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤ä‡≤ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤á‡≤¶‡≥Å ‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤¶‡≥ä‡≤°‡≥ç‡≤° ‡≤Æ‡≤®‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤ö‡≤ø‡≤ï‡≥ç‡≤ï ‡≤Æ‡≤ó‡≥Å ‡≤Ö‡≤≤‡≥ç‡≤≤.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤í‡≤≥‡≥ç‡≤≥‡≥Ü‡≤Ø ‡≤π‡≥Å‡≤°‡≥Å‡≤ó ‡≤π‡≥å‡≤¶‡≥Å.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤ï‡≥Ü‡≤ü‡≥ç‡≤ü ‡≤ï‡≤®‡≤∏‡≥Å ‡≤ï‡≤Ç‡≤°‡≥Ü.", "‡≤á‡≤µ‡≥Å ‡≤π‡≥ä‡≤∏ ‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü‡≤ó‡≤≥‡≥Å.", "‡≤Ö‡≤¶‡≥Å ‡≤π‡≤≥‡≥Ü‡≤Ø ‡≤®‡≥Ü‡≤®‡≤™‡≥Å ‡≤Æ‡≤æ‡≤§‡≥ç‡≤∞.", "‡≤à ‡≤™‡≥ç‡≤∞‡≤∂‡≥ç‡≤®‡≥Ü ‡≤∏‡≥Å‡≤≤‡≤≠‡≤µ‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", "‡≤Ü ‡≤ï‡≥Ü‡≤≤‡≤∏ ‡≤ï‡≤∑‡≥ç‡≤ü‡≤ï‡≤∞‡≤µ‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤¨‡≥á‡≤ó ‡≤¨‡≤∞‡≤¨‡≥á‡≤ï‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤®‡≤ø‡≤ß‡≤æ‡≤®‡≤µ‡≤æ‡≤ó‡≤ø ‡≤π‡≥ã‡≤¶‡≤®‡≥Å.", "‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤á‡≤°‡≥Å.", "‡≤Ü ‡≤ö‡≤ø‡≤§‡≥ç‡≤∞‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Ö‡≤≤‡≥ç‡≤≤‡≤ø ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤®‡≤®‡≥ç‡≤® ‡≤π‡≤§‡≥ç‡≤§‡≤ø‡≤∞ ‡≤¨‡≤æ.", "‡≤Ö‡≤µ‡≤®‡≤ø‡≤Ç‡≤¶ ‡≤¶‡≥Ç‡≤∞ ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Ü‡≤ï‡≤æ‡≤∂‡≤¶ ‡≤Æ‡≥á‡≤≤‡≥Ü ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤Æ‡≤∞‡≤¶‡≤ø‡≤Ç‡≤¶ ‡≤ï‡≥Ü‡≤≥‡≤ó‡≥Ü ‡≤á‡≤≥‡≤ø‡≤∏‡≥Å.", "‡≤Æ‡≤®‡≥Ü‡≤Ø ‡≤í‡≤≥‡≤ó‡≥Ü ‡≤¨‡≤æ.", "‡≤∂‡≤æ‡≤≤‡≥Ü‡≤Ø ‡≤π‡≥ä‡≤∞‡≤ó‡≥Ü ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤∏‡≤æ‡≤≤‡≤ø‡≤®‡≤≤‡≥ç‡≤≤‡≤ø ‡≤Æ‡≥Å‡≤Ç‡≤¶‡≥Ü ‡≤∏‡≤∞‡≤ø.", "‡≤ï‡≤®‡≥ç‡≤®‡≤°‡≤ø‡≤Ø ‡≤π‡≤ø‡≤Ç‡≤¶‡≥Ü ‡≤®‡≥ã‡≤°‡≥Å.", "‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü ‡≤Ø‡≤æ‡≤∞‡≥Å ‡≤¨‡≤Ç‡≤¶‡≤∞‡≥Å?", "‡≤®‡≤ø‡≤®‡≤ó‡≥Ü ‡≤è‡≤®‡≥Å ‡≤¨‡≥á‡≤ï‡≥Å?", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤Ø‡≤æ‡≤µ‡≤æ‡≤ó ‡≤¨‡≤∞‡≥Å‡≤µ‡≥Ü?", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤é‡≤≤‡≥ç‡≤≤‡≤ø‡≤ó‡≥Ü ‡≤π‡≥ã‡≤¶‡≤®‡≥Å?", "‡≤á‡≤¶‡≤®‡≥ç‡≤®‡≥Å ‡≤π‡≥á‡≤ó‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≥Ü?", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤è‡≤ï‡≥Ü ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≥Ü?", "‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü ‡≤¨‡≤Ç‡≤¶‡≥Ü.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü ‡≤π‡≥ã‡≤ó‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤∏‡≤ø‡≤®‡≤ø‡≤Æ‡≤æ ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤π‡≤æ‡≤°‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤Ü ‡≤π‡≤ï‡≥ç‡≤ï‡≤ø ‡≤π‡≤æ‡≤∞‡≤ø‡≤§‡≥Å.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤™‡≤Ç‡≤¶‡≥ç‡≤Ø ‡≤ó‡≥Ü‡≤¶‡≥ç‡≤¶‡≥Ü‡≤µ‡≥Å.", "‡≤®‡≥Ä‡≤µ‡≥Å ‡≤è‡≤ï‡≥Ü ‡≤∏‡≥ã‡≤§‡≤∞‡≥Å?", "‡≤Ö‡≤µ‡≤∞‡≥Å ‡≤®‡≤æ‡≤ü‡≤ï ‡≤®‡≥ã‡≤°‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤á‡≤µ‡≤∞‡≥Å ‡≤®‡≤®‡≥ç‡≤® ‡≤∏‡≥ç‡≤®‡≥á‡≤π‡≤ø‡≤§‡≤∞‡≥Å.", "‡≤Ö‡≤Æ‡≥ç‡≤Æ ‡≤Ö‡≤°‡≥Å‡≤ó‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤™‡≥ç‡≤™ ‡≤™‡≥á‡≤™‡≤∞‡≥ç ‡≤ì‡≤¶‡≤ø‡≤¶‡≤∞‡≥Å.", "‡≤Ö‡≤£‡≥ç‡≤£ ‡≤ï‡≥ç‡≤∞‡≤ø‡≤ï‡≥Ü‡≤ü‡≥ç ‡≤Ü‡≤°‡≤ø‡≤¶‡≤®‡≥Å.", "‡≤§‡≤Æ‡≥ç‡≤Æ ‡≤∂‡≤æ‡≤≤‡≥Ü‡≤ó‡≥Ü ‡≤π‡≥ã‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤ï‡≥ç‡≤ï ‡≤ö‡≤ø‡≤§‡≥ç‡≤∞ ‡≤¨‡≤∞‡≥Ü‡≤¶‡≤≥‡≥Å.", "‡≤§‡≤Ç‡≤ó‡≤ø ‡≤ó‡≥ä‡≤Ç‡≤¨‡≥Ü ‡≤Ü‡≤°‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤®‡≤®‡≥ç‡≤® ‡≤ó‡≥Ü‡≤≥‡≥Ü‡≤Ø ‡≤¨‡≤Ç‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥ ‡≤ó‡≥Ü‡≤≥‡≤§‡≤ø ‡≤π‡≥ã‡≤¶‡≤≥‡≥Å.", "‡≤Ü ‡≤Æ‡≤ó‡≥Å ‡≤Ö‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü.", "‡≤¶‡≥á‡≤µ‡≤∞‡≥Å ‡≤é‡≤≤‡≥ç‡≤≤‡≥Ü‡≤°‡≥Ü ‡≤á‡≤¶‡≥ç‡≤¶‡≤æ‡≤®‡≥Ü.", "‡≤®‡≤æ‡≤®‡≥Å ‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï ‡≤ì‡≤¶‡≤ø‡≤¶‡≥Ü‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤™‡≥Ü‡≤®‡≥ç‡≤®‡≥Å ‡≤§‡≤Ç‡≤¶‡≤®‡≥Å.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤¨‡≤£‡≥ç‡≤£ ‡≤π‡≤ö‡≥ç‡≤ö‡≤ø‡≤¶‡≤≥‡≥Å.", "‡≤®‡≥Ä‡≤®‡≥Å ‡≤∏‡≤∞‡≤ø ‡≤π‡≥á‡≤≥‡≤ø‡≤¶‡≥Ü.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤§‡≤™‡≥ç‡≤™‡≥Å ‡≤Æ‡≤æ‡≤°‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤." ] },
             { title: "‡≤™‡≤æ‡≤† 4: ‡≤¶‡≥ä‡≤°‡≥ç‡≤° ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø‡≤ó‡≤≥‡≥Å", shuffle: false, content: [ "‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü ‡≤¨‡≥Ü‡≤Ç‡≤ó‡≤≥‡≥Ç‡≤∞‡≤ø‡≤ó‡≥Ü ‡≤π‡≥ã‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤®‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü ‡≤Ö‡≤Ç‡≤ó‡≤°‡≤ø‡≤Ø‡≤ø‡≤Ç‡≤¶ ‡≤π‡≤£‡≥ç‡≤£‡≥Å ‡≤§‡≤Ç‡≤¶‡≤≥‡≥Å.", "‡≤à ‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤®‡≤®‡≤ó‡≥Ü ‡≤ï‡≥ä‡≤°‡≤ø.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤á‡≤Ç‡≤¶‡≥Å ‡≤∏‡≤Ç‡≤ú‡≥Ü ‡≤∏‡≤ø‡≤®‡≤ø‡≤Æ‡≤æ ‡≤®‡≥ã‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤µ‡≥Ü.", "‡≤Æ‡≤ï‡≥ç‡≤ï‡≤≥‡≥Å ‡≤Ü‡≤ü‡≤¶ ‡≤Æ‡≥à‡≤¶‡≤æ‡≤®‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤Ü‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥ç‡≤¶‡≤æ‡≤∞‡≥Ü.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤™‡≥ç‡≤∞‡≤§‡≤ø‡≤¶‡≤ø‡≤® ‡≤¨‡≥Ü‡≤≥‡≤ø‡≤ó‡≥ç‡≤ó‡≥Ü ‡≤¨‡≥á‡≤ó ‡≤è‡≤≥‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤®‡≥Ü.", "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤ï‡≤®‡≥ç‡≤®‡≤°‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤Æ‡≤æ‡≤§‡≤®‡≤æ‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≤æ‡≤≥‡≥Ü.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤® ‡≤µ‡≤æ‡≤∞ ‡≤™‡≥ç‡≤∞‡≤µ‡≤æ‡≤∏ ‡≤π‡≥ã‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤µ‡≥Ü.", "‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤¨‡≤æ‡≤ó‡≤ø‡≤≤‡≤®‡≥ç‡≤®‡≥Å ‡≤Æ‡≥Å‡≤ö‡≥ç‡≤ö‡≤ø ‡≤í‡≤≥‡≤ó‡≥Ü ‡≤¨‡≤®‡≥ç‡≤®‡≤ø.", "‡≤à ‡≤ä‡≤ü ‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤∞‡≥Å‡≤ö‡≤ø‡≤ï‡≤∞‡≤µ‡≤æ‡≤ó‡≤ø ‡≤á‡≤¶‡≥Ü.", "‡≤Æ‡≤≥‡≥Ü ‡≤¨‡≤Ç‡≤¶ ‡≤ï‡≤æ‡≤∞‡≤£ ‡≤®‡≤æ‡≤µ‡≥Å ‡≤Æ‡≤®‡≥Ü‡≤Ø‡≤≤‡≥ç‡≤≤‡≥á ‡≤â‡≤≥‡≤ø‡≤¶‡≥Ü‡≤µ‡≥Å.", "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤§‡≤®‡≥ç‡≤® ‡≤∏‡≥ç‡≤®‡≥á‡≤π‡≤ø‡≤§‡≤® ‡≤ú‡≥ä‡≤§‡≥Ü ‡≤Ü‡≤∏‡≥ç‡≤™‡≤§‡≥ç‡≤∞‡≥Ü‡≤ó‡≥Ü ‡≤π‡≥ã‡≤¶‡≤®‡≥Å.", "‡≤®‡≤æ‡≤µ‡≥Å ‡≤¨‡≤∏‡≥ç‡≤∏‡≤ø‡≤®‡≤≤‡≥ç‡≤≤‡≤ø ‡≤™‡≥ç‡≤∞‡≤Ø‡≤æ‡≤£ ‡≤Æ‡≤æ‡≤°‡≤ø ‡≤¶‡≥á‡≤µ‡≤∏‡≥ç‡≤•‡≤æ‡≤® ‡≤§‡≤≤‡≥Å‡≤™‡≤ø‡≤¶‡≥Ü‡≤µ‡≥Å.", "‡≤à ‡≤ï‡≤•‡≥Ü‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤®‡≤æ‡≤®‡≥Å ‡≤ö‡≤ø‡≤ï‡≥ç‡≤ï‡≤µ‡≤®‡≤ø‡≤¶‡≥ç‡≤¶‡≤æ‡≤ó ‡≤ï‡≥á‡≤≥‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ü.", "‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≥Ü‡≤Ø‡≤≤‡≥ç‡≤≤‡≤ø ‡≤í‡≤≥‡≥ç‡≤≥‡≥Ü‡≤Ø ‡≤Ö‡≤Ç‡≤ï‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤™‡≤°‡≥Ü‡≤Ø‡≤≤‡≥Å ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø ‡≤ì‡≤¶‡≤¨‡≥á‡≤ï‡≥Å." ] }
        ];

        // --- Global State Variables ---
        let currentMode = 'learn'; let currentLessonIndexForTest = -1; let currentContentIndex = 0; let activeContent = []; let synth = window.speechSynthesis; let recognition; let isRecording = false; let isCurrentItemCorrect = false; let micPermissionState = 'prompt'; let hintCounter = 0; let lessonScores = {}; let testScore = 0; let currentItemHintUsed = false; let nextButtonTimer = null;

        // --- DOM Element References ---
        const menuButton = document.getElementById('menuButton'); const menuPanel = document.getElementById('menuPanel'); const menuLearnLink = document.getElementById('menuLearn'); const menuTestLink = document.getElementById('menuTest'); const appContainer = document.getElementById('appContainer'); const testSelectionArea = document.getElementById('testSelectionArea'); const testResultsArea = document.getElementById('testResultsArea'); const testResultScore = document.getElementById('testResultScore'); const testResultStatus = document.getElementById('testResultStatus'); const displayArea = document.getElementById('displayArea'); const lessonTitleElement = document.getElementById('lessonTitle'); const lessonScoreElement = document.getElementById('lessonScore'); const prevButton = document.getElementById('prevButton'); const nextButton = document.getElementById('nextButton'); const speakButton = document.getElementById('speakButton'); const recordButton = document.getElementById('recordButton'); const messageBox = document.getElementById('messageBox'); const messageBoxIcon = messageBox.querySelector('i'); const messageBoxText = messageBox.querySelector('span'); const recognizedTextElement = document.getElementById('recognizedText'); const recognizedTextIcon = recognizedTextElement.querySelector('i'); const recognizedTextSpan = recognizedTextElement.querySelector('span'); const progressBar = document.getElementById('progressBar'); const progressBarContainer = document.getElementById('progressBarContainer'); const hintCounterDisplay = document.getElementById('hintCounterDisplay'); const hintCountSpan = document.getElementById('hintCount'); const instructionText = document.getElementById('instructionText');

        // --- Core Application Functions ---
        function toggleMenu() { menuPanel.classList.toggle('open'); }
        function selectModeFromMenu(mode) { setMode(mode); toggleMenu(); }
        function setMode(mode) { currentMode = mode; console.log("Mode set to:", currentMode); menuLearnLink.classList.toggle('active', mode === 'learn'); menuTestLink.classList.toggle('active', mode === 'test'); appContainer.classList.remove('hidden'); testResultsArea.classList.add('hidden'); testSelectionArea.classList.toggle('hidden', mode !== 'test'); if (mode === 'learn') { initializeLearnMode(); } else { populateTestSelection(); appContainer.classList.add('hidden'); } }
        function populateTestSelection() { testSelectionArea.innerHTML = `<h2 class="text-xl font-bold mb-4 text-indigo-800">‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≥Ü‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø (Select Test)</h2>`; lessons.forEach((lesson, index) => { const btn = document.createElement('button'); btn.textContent = lesson.title; btn.className = 'test-select-button'; btn.onclick = () => startTest(index); testSelectionArea.appendChild(btn); }); }
        function initializeLearnMode() { prepareCourseContent(false); if (activeContent.length > 0) { currentContentIndex = 0; hintCounter = 0; hintCountSpan.textContent = hintCounter; updateDisplay(); appContainer.classList.remove('hidden'); testSelectionArea.classList.add('hidden'); testResultsArea.classList.add('hidden'); } else { showMessage("‡≤ï‡≤≤‡≤ø‡≤ï‡≥Ü‡≤Ø ‡≤µ‡≤ø‡≤∑‡≤Ø ‡≤ï‡≤Ç‡≤°‡≥Å‡≤¨‡≤Ç‡≤¶‡≤ø‡≤≤‡≥ç‡≤≤!", 'error'); } }
        function startTest(lessonIndex) { currentLessonIndexForTest = lessonIndex; console.log(`Starting test for Lesson ${lessonIndex + 1}: ${lessons[lessonIndex].title}`); prepareCourseContent(true, lessonIndex); if (activeContent.length > 0) { currentContentIndex = 0; testScore = 0; updateDisplay(); testSelectionArea.classList.add('hidden'); appContainer.classList.remove('hidden'); testResultsArea.classList.add('hidden'); } else { showMessage(`‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≥Ü‡≤Ø ‡≤µ‡≤ø‡≤∑‡≤Ø ‡≤ï‡≤Ç‡≤°‡≥Å‡≤¨‡≤Ç‡≤¶‡≤ø‡≤≤‡≥ç‡≤≤! (Lesson ${lessonIndex + 1})`, 'error'); } }
        function prepareCourseContent(isTest = false, testLessonIndex = -1) { activeContent = []; lessonScores = {}; if (isTest && testLessonIndex >= 0 && testLessonIndex < lessons.length) { const lesson = lessons[testLessonIndex]; let lessonContent = [...lesson.content]; if (lesson.shuffle) { lessonContent = shuffleArray(lessonContent); } const testItems = lessonContent.slice(0, TEST_SIZE); testItems.forEach((item) => { activeContent.push({ text: item, lessonTitle: lesson.title }); }); console.log(`Prepared ${activeContent.length} items for test: ${lesson.title}`); } else if (!isTest) { lessons.forEach((lesson) => { let contentToAdd = [...lesson.content]; if (lesson.shuffle) { contentToAdd = shuffleArray(contentToAdd); } lessonScores[lesson.title] = { correct: 0, total: contentToAdd.length, hints: 0 }; contentToAdd.forEach((item, itemIndex) => { activeContent.push({ text: item, lessonTitle: lesson.title, isFirstItemOfLesson: itemIndex === 0 }); }); }); console.log(`Prepared ${activeContent.length} items for learn mode.`); console.log("Initial Learn Scores:", lessonScores); } else { console.error("Invalid state for prepareCourseContent"); } }
        function updateDisplay() { clearTimeout(nextButtonTimer); nextButtonTimer = null; displayArea.classList.remove('correct-answer-flash'); if (activeContent.length === 0 || currentContentIndex >= activeContent.length) { if (currentMode === 'test' && activeContent.length > 0) { showTestResults(); } return; } const currentItem = activeContent[currentContentIndex]; displayArea.textContent = currentItem.text; lessonTitleElement.textContent = currentItem.lessonTitle; isCurrentItemCorrect = false; if (currentMode === 'learn') { currentItemHintUsed = false; } resetValidationUI(); speakButton.classList.toggle('hidden', currentMode === 'test'); hintCounterDisplay.classList.toggle('hidden', currentMode === 'test'); lessonScoreElement.classList.toggle('hidden', currentMode === 'test'); instructionText.textContent = currentMode === 'test' ? "‡≤ï‡≥Ü‡≤≥‡≤ó‡≤ø‡≤®‡≤¶‡≤®‡≥ç‡≤®‡≥Å ‡≤ì‡≤¶‡≤ø ‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤ó‡≤ø ‡≤π‡≥á‡≤≥‡≤ø" : "‡≤ï‡≥Ü‡≤≥‡≤ó‡≤ø‡≤®‡≤¶‡≤®‡≥ç‡≤®‡≥Å ‡≤ì‡≤¶‡≤ø '‡≤ï‡≥á‡≤≥‡≤ø' ‡≤Ö‡≤•‡≤µ‡≤æ '‡≤π‡≥á‡≤≥‡≤ø' ‡≤¨‡≤ü‡≤®‡≥ç ‡≤í‡≤§‡≥ç‡≤§‡≤ø‡≤∞‡≤ø"; if (currentMode === 'learn') { updateLessonScoreDisplay(); } updateNavButtons(); updateProgressBar(); if (currentMode === 'learn' && currentItem.isFirstItemOfLesson && currentContentIndex > 0) { showMessage(`‡≤π‡≥ä‡≤∏ ‡≤™‡≤æ‡≤† ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠: ${currentItem.lessonTitle}`, 'info'); } else if (currentMode === 'learn' && currentContentIndex === 0 && currentItem.isFirstItemOfLesson) { showMessage(`‡≤™‡≤æ‡≤† ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠: ${currentItem.lessonTitle}`, 'info'); } else if (currentMode === 'test' && currentContentIndex === 0) { showMessage(`‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≥Ü ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠: ${currentItem.lessonTitle}`, 'info'); } }
        function updateLessonScoreDisplay() { if (currentMode !== 'learn' || activeContent.length === 0) { lessonScoreElement.textContent = ""; return; } const currentLessonTitle = activeContent[currentContentIndex].lessonTitle; const score = lessonScores[currentLessonTitle]; if (score) { lessonScoreElement.textContent = `‡≤™‡≤æ‡≤†‡≤¶ ‡≤∏‡≥ç‡≤ï‡≥ã‡≤∞‡≥ç: ${score.correct} / ${score.total}`; } else { lessonScoreElement.textContent = ""; } }
        function updateProgressBar() { const totalItems = activeContent.length; const completedItems = currentContentIndex + 1; const progress = totalItems > 0 ? (completedItems / totalItems) * 100 : 0; progressBar.style.width = `${progress}%`; progressBarContainer.title = `‡≤™‡≥ç‡≤∞‡≤ó‡≤§‡≤ø: ${completedItems} / ${totalItems}`; }
        function updateNavButtons() { prevButton.disabled = currentMode === 'test' || currentContentIndex === 0; const isLastItem = currentContentIndex >= activeContent.length - 1; nextButton.disabled = isLastItem || !isCurrentItemCorrect || nextButtonTimer !== null; }
        function speakText(text) { if (synth.speaking) { synth.cancel(); setTimeout(() => speakText(text), 100); return; } if (text === '') return; let voices = synth.getVoices(); let kannadaVoice = voices.find(voice => voice.lang === 'kn-IN') || voices.find(voice => voice.lang.startsWith('kn')) || voices.find(voice => voice.lang === 'hi-IN') || voices.find(voice => voice.default); if (!kannadaVoice) { showMessage("‡≤Ø‡≤æ‡≤µ‡≥Å‡≤¶‡≥á ‡≤∏‡≥Ç‡≤ï‡≥ç‡≤§ ‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤≤‡≤≠‡≥ç‡≤Ø‡≤µ‡≤ø‡≤≤‡≥ç‡≤≤.", 'error'); return; } const utterThis = new SpeechSynthesisUtterance(text); utterThis.voice = kannadaVoice; utterThis.lang = kannadaVoice.lang; utterThis.pitch = 1; utterThis.rate = 0.85; utterThis.onstart = () => { speakButton.disabled = true; }; utterThis.onend = () => { speakButton.disabled = false; }; utterThis.onerror = (event) => { console.error('SpeechSynthesis Error:', event.error, 'Utterance:', text, 'Voice:', kannadaVoice?.name); showMessage(`‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤¶‡≥ã‡≤∑: ${event.error}. ‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤™‡≥Å‡≤ü‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤∞‡≤ø‡≤´‡≥ç‡≤∞‡≥Ü‡≤∂‡≥ç ‡≤Æ‡≤æ‡≤°‡≤≤‡≥Å ‡≤™‡≥ç‡≤∞‡≤Ø‡≤§‡≥ç‡≤®‡≤ø‡≤∏‡≤ø.`, 'error'); speakButton.disabled = false; }; synth.speak(utterThis); }
        function showMessage(message, type = 'info') { messageBoxText.textContent = message; const isResult = type === 'pass' || type === 'fail'; const baseClass = isResult ? 'mt-6 font-semibold' : 'mt-6'; messageBox.className = `${baseClass} ${ type === 'error' ? 'message-error' : type === 'pass' ? 'message-pass' : type === 'fail' ? 'message-fail' : 'message-info' }`; messageBoxIcon.className = `fas ${ type === 'error' ? 'fa-exclamation-circle' : type === 'pass' ? 'fa-check-circle' : type === 'fail' ? 'fa-times-circle' : 'fa-info-circle' }`; }
        function updateValidationUI(status, message = "") { let iconClass = 'fas fa-comment-dots'; let textContent = message || '‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤∏‡≤∞‡≤¶‡≤ø'; let elementClass = 'mt-4 validation-default'; switch (status) { case 'correct': elementClass = 'mt-4 validation-correct'; iconClass = 'fas fa-check-circle fa-beat'; textContent = "‡≤∏‡≤∞‡≤ø!"; break; case 'incorrect': elementClass = 'mt-4 validation-incorrect'; iconClass = 'fas fa-times-circle fa-shake'; textContent = "‡≤§‡≤™‡≥ç‡≤™‡≥Å! ‡≤Æ‡≤§‡≥ç‡≤§‡≥Ü ‡≤™‡≥ç‡≤∞‡≤Ø‡≤§‡≥ç‡≤®‡≤ø‡≤∏‡≤ø"; break; case 'listening': elementClass = 'mt-4 validation-listening'; iconClass = 'fas fa-microphone-alt fa-beat-fade'; textContent = "‡≤ï‡≥á‡≤≥‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü..."; break; case 'processing': elementClass = 'mt-4 validation-listening'; iconClass = 'fas fa-spinner fa-spin'; textContent = "‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤ø‡≤¶‡≥Ü..."; break; } recognizedTextElement.className = elementClass; recognizedTextIcon.className = iconClass; recognizedTextSpan.textContent = textContent; }
        function resetValidationUI() { updateValidationUI('default', '‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤∏‡≤∞‡≤¶‡≤ø'); }
        function initializeSpeechRecognition() { window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition; if (!window.SpeechRecognition) { showMessage("‡≤ï‡≥ç‡≤∑‡≤Æ‡≤ø‡≤∏‡≤ø, ‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤ó‡≥Å‡≤∞‡≥Å‡≤§‡≤ø‡≤∏‡≥Å‡≤µ‡≤ø‡≤ï‡≥Ü ‡≤¨‡≥Ü‡≤Ç‡≤¨‡≤≤‡≤ø‡≤∏‡≥Å‡≤µ‡≥Å‡≤¶‡≤ø‡≤≤‡≥ç‡≤≤.", 'error'); recordButton.disabled = true; return false; } recognition = new SpeechRecognition(); recognition.lang = 'kn-IN'; recognition.interimResults = false; recognition.maxAlternatives = 1;
             recognition.onstart = () => { isRecording = true; recordButton.classList.add('recording'); recordButton.innerHTML = `<i class="fas fa-stop-circle"></i> ‡≤®‡≤ø‡≤≤‡≥ç‡≤≤‡≤ø‡≤∏‡≤ø`; updateValidationUI('listening'); };
             recognition.onresult = (event) => {
                 updateValidationUI('processing'); const speechResult = event.results[0][0].transcript.trim(); const confidence = event.results[0][0].confidence; console.log(`Recognition: "${speechResult}" (Confidence: ${confidence.toFixed(2)})`); const currentTargetText = activeContent[currentContentIndex].text; const currentLessonTitle = activeContent[currentContentIndex].lessonTitle; const normalize = (str) => str.replace(/[.,!?]/g, '').replace(/\s+/g, ' ').trim().toLowerCase();
                 if (normalize(speechResult) === normalize(currentTargetText)) {
                     if (!isCurrentItemCorrect) { if (currentMode === 'learn') { lessonScores[currentLessonTitle].correct++; updateLessonScoreDisplay(); console.log("Updated Learn Scores:", lessonScores); } else { testScore++; console.log("Test Score:", testScore); } }
                     isCurrentItemCorrect = true; updateValidationUI('correct'); displayArea.classList.add('correct-answer-flash'); setTimeout(() => { displayArea.classList.remove('correct-answer-flash'); }, 800); nextButton.disabled = true; clearTimeout(nextButtonTimer);
                     // FIX: Clear timer variable *before* calling updateNavButtons in timeout
                     nextButtonTimer = setTimeout(() => {
                         nextButtonTimer = null; // Clear timer variable
                         updateNavButtons(); // Re-evaluate and enable Next button if appropriate
                         if (currentMode === 'learn') { showMessage("‡≤§‡≥Å‡≤Ç‡≤¨‡≤æ ‡≤ö‡≥Ü‡≤®‡≥ç‡≤®‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü! '‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å' ‡≤í‡≤§‡≥ç‡≤§‡≤ø‡≤∞‡≤ø.", 'info'); }
                         else { showMessage("‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü! '‡≤Æ‡≥Å‡≤Ç‡≤¶‡≤ø‡≤®‡≤¶‡≥Å' ‡≤í‡≤§‡≥ç‡≤§‡≤ø‡≤∞‡≤ø.", 'pass'); }
                     }, 800);

                 } else {
                     isCurrentItemCorrect = false; updateValidationUI('incorrect');
                     if (currentMode === 'learn') { showMessage(`‡≤ï‡≥á‡≤≥‡≤ø‡≤∏‡≤ø‡≤¶‡≥ç‡≤¶‡≥Å: "${speechResult}". ‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤¶‡≤¶‡≥ç‡≤¶‡≥Å: "${currentTargetText}".`, 'error'); }
                     else { showMessage(`‡≤§‡≤™‡≥ç‡≤™‡≥Å. ‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤¶‡≤¶‡≥ç‡≤¶‡≥Å: "${currentTargetText}"`, 'error'); }
                     // FIX: Ensure nav buttons are updated if incorrect
                     updateNavButtons();
                 }
                 setTimeout(() => { if(isRecording) stopRecordingVisuals(); }, 100);
             };
             recognition.onspeechend = () => { if (isRecording) { updateValidationUI('processing'); } };
             recognition.onnomatch = () => { updateValidationUI('incorrect', "‡≤∏‡≥ç‡≤™‡≤∑‡≥ç‡≤ü‡≤µ‡≤æ‡≤ó‡≤ø ‡≤ï‡≥á‡≤≥‡≤ø‡≤∏‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤"); showMessage("‡≤ï‡≥ç‡≤∑‡≤Æ‡≤ø‡≤∏‡≤ø, ‡≤®‡≤®‡≤ó‡≥Ü ‡≤Ö‡≤∞‡≥ç‡≤•‡≤µ‡≤æ‡≤ó‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤. ‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≤§‡≥ç‡≤§‡≥Ü ‡≤™‡≥ç‡≤∞‡≤Ø‡≤§‡≥ç‡≤®‡≤ø‡≤∏‡≤ø.", 'error'); stopRecording(); };
             recognition.onerror = (event) => { console.error('SpeechRecognition error:', event.error); let errorMsg = "‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤¶‡≥ã‡≤∑: "; switch (event.error) { case 'no-speech': errorMsg += "‡≤Æ‡≤æ‡≤§‡≥Å ‡≤ï‡≥á‡≤≥‡≤ø‡≤∏‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤."; break; case 'audio-capture': errorMsg += "‡≤Æ‡≥à‡≤ï‡≥ç‡≤∞‡≥ä‡≤´‡≥ã‡≤®‡≥ç ‡≤∏‡≤Æ‡≤∏‡≥ç‡≤Ø‡≥Ü."; micPermissionState = 'prompt'; break; case 'not-allowed': errorMsg += "‡≤Æ‡≥à‡≤ï‡≥ç‡≤∞‡≥ä‡≤´‡≥ã‡≤®‡≥ç ‡≤Ö‡≤®‡≥Å‡≤Æ‡≤§‡≤ø ‡≤¨‡≥á‡≤ï‡≥Å."; micPermissionState = 'denied'; break; default: errorMsg += event.error; } resetValidationUI(); showMessage(errorMsg, 'error'); stopRecording(); };
             recognition.onend = () => { stopRecording(); }; return true;
        }
        function startRecognitionEngine() { if (!recognition || isRecording) return; try { recognition.start(); } catch (e) { console.error("Error starting recognition engine:", e); showMessage("‡≤∞‡≥Ü‡≤ï‡≤æ‡≤∞‡≥ç‡≤°‡≤ø‡≤Ç‡≤ó‡≥ç ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠‡≤ø‡≤∏‡≤≤‡≥Å ‡≤∏‡≤æ‡≤ß‡≥ç‡≤Ø‡≤µ‡≤æ‡≤ó‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤.", 'error'); stopRecordingVisuals(); } }
        function requestMicPermissionAndStart() { navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => { stream.getTracks().forEach(track => track.stop()); micPermissionState = 'granted'; console.log("Mic permission granted via getUserMedia."); startRecognitionEngine(); }).catch(err => { console.error("getUserMedia error:", err); micPermissionState = 'denied'; if (err.name === 'NotAllowedError' || err.name === 'PermissionDeniedError') { showMessage("‡≤Æ‡≥à‡≤ï‡≥ç‡≤∞‡≥ä‡≤´‡≥ã‡≤®‡≥ç ‡≤¨‡≤≥‡≤∏‡≤≤‡≥Å ‡≤Ö‡≤®‡≥Å‡≤Æ‡≤§‡≤ø ‡≤¨‡≥á‡≤ï‡≥Å.", 'error'); updateValidationUI('default', '‡≤Æ‡≥à‡≤ï‡≥ç ‡≤Ö‡≤®‡≥Å‡≤Æ‡≤§‡≤ø ‡≤®‡≤ø‡≤∞‡≤æ‡≤ï‡≤∞‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü'); } else { showMessage(`‡≤Æ‡≥à‡≤ï‡≥ç‡≤∞‡≥ä‡≤´‡≥ã‡≤®‡≥ç ‡≤¶‡≥ã‡≤∑: ${err.name}`, 'error'); updateValidationUI('default', `‡≤Æ‡≥à‡≤ï‡≥ç ‡≤¶‡≥ã‡≤∑: ${err.name}`); } stopRecordingVisuals(); }); }
        async function checkMicPermissionAndStart() { if (typeof navigator.permissions?.query !== 'function') { console.warn("Permissions API not supported."); requestMicPermissionAndStart(); return; } try { const permissionStatus = await navigator.permissions.query({ name: 'microphone' }); micPermissionState = permissionStatus.state; console.log(`Mic permission state: ${micPermissionState}`); if (micPermissionState === 'granted') { startRecognitionEngine(); } else if (micPermissionState === 'prompt') { requestMicPermissionAndStart(); } else { showMessage("‡≤Æ‡≥à‡≤ï‡≥ç‡≤∞‡≥ä‡≤´‡≥ã‡≤®‡≥ç ‡≤Ö‡≤®‡≥Å‡≤Æ‡≤§‡≤ø ‡≤®‡≤ø‡≤∞‡≤æ‡≤ï‡≤∞‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü.", 'error'); updateValidationUI('default', '‡≤Æ‡≥à‡≤ï‡≥ç ‡≤Ö‡≤®‡≥Å‡≤Æ‡≤§‡≤ø ‡≤®‡≤ø‡≤∞‡≤æ‡≤ï‡≤∞‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü'); } permissionStatus.onchange = () => { console.log(`Mic permission changed: ${permissionStatus.state}`); micPermissionState = permissionStatus.state; }; } catch (err) { console.error("Error querying permissions:", err); showMessage("‡≤Ö‡≤®‡≥Å‡≤Æ‡≤§‡≤ø ‡≤∏‡≥ç‡≤•‡≤ø‡≤§‡≤ø ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤≤‡≥Å ‡≤∏‡≤æ‡≤ß‡≥ç‡≤Ø‡≤µ‡≤æ‡≤ó‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤.", 'error'); requestMicPermissionAndStart(); } }
        function stopRecording() { if (recognition && isRecording) { try { recognition.stop(); } catch (e) { console.warn("Error stopping recognition:", e); } } stopRecordingVisuals(); }
        function stopRecordingVisuals() { isRecording = false; recordButton.classList.remove('recording'); recordButton.innerHTML = `<i class="fas fa-microphone-lines"></i> ‡≤π‡≥á‡≤≥‡≤ø`; const currentStatus = recognizedTextElement.className; if (currentStatus.includes('validation-listening') || currentStatus.includes('fa-spinner')) { resetValidationUI(); } }
        function showTestResults() { const totalQuestions = activeContent.length; const score = testScore; const passed = score >= TEST_PASS_THRESHOLD; console.log(`Test finished. Score: ${score}/${totalQuestions}. Passed: ${passed}`); testResultScore.textContent = `‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤∏‡≥ç‡≤ï‡≥ã‡≤∞‡≥ç: ${score} / ${totalQuestions}`; testResultStatus.textContent = passed ? "‡≤â‡≤§‡≥ç‡≤§‡≥Ä‡≤∞‡≥ç‡≤£! (Passed!) üéâ" : "‡≤Ö‡≤®‡≥Å‡≤§‡≥ç‡≤§‡≥Ä‡≤∞‡≥ç‡≤£ (Failed)"; testResultStatus.className = `text-3xl font-bold mb-6 ${passed ? 'text-green-600' : 'text-red-600'}`; appContainer.classList.add('hidden'); testResultsArea.classList.remove('hidden'); showMessage(`‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≥Ü ‡≤Æ‡≥Å‡≤ó‡≤ø‡≤¶‡≤ø‡≤¶‡≥Ü. ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤∏‡≥ç‡≤ï‡≥ã‡≤∞‡≥ç: ${score}/${totalQuestions}.`, passed ? 'pass' : 'fail'); }
        function restartApp() { currentContentIndex = 0; activeContent = []; testScore = 0; hintCounter = 0; isCurrentItemCorrect = false; currentLessonIndexForTest = -1; clearTimeout(nextButtonTimer); nextButtonTimer = null; appContainer.classList.add('hidden'); testResultsArea.classList.add('hidden'); testSelectionArea.classList.add('hidden'); currentMode = 'learn'; menuLearnLink.classList.add('active'); menuTestLink.classList.remove('active'); initializeLearnMode(); progressBar.style.width = `0%`; progressBarContainer.title = `‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤™‡≥ç‡≤∞‡≤ó‡≤§‡≤ø: 0 / 0`; hintCountSpan.textContent = '0'; lessonScoreElement.textContent = ""; resetValidationUI(); showMessage("‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≥ã‡≤°‡≥ç ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø.", 'info'); }

        // --- Event Listeners Setup ---
        prevButton.addEventListener('click', () => { if (currentMode === 'learn' && currentContentIndex > 0) { currentContentIndex--; if (synth.speaking) synth.cancel(); if (isRecording) stopRecording(); updateDisplay(); } });
        nextButton.addEventListener('click', () => { if (!nextButton.disabled) { if (currentContentIndex < activeContent.length - 1) { currentContentIndex++; if (synth.speaking) synth.cancel(); if (isRecording) stopRecording(); updateDisplay(); } else { if (currentMode === 'test') { showTestResults(); } else { showMessage("‡≤Ö‡≤≠‡≤ø‡≤®‡≤Ç‡≤¶‡≤®‡≥Ü‡≤ó‡≤≥‡≥Å! ‡≤®‡≥Ä‡≤µ‡≥Å ‡≤é‡≤≤‡≥ç‡≤≤‡≤æ ‡≤™‡≤æ‡≤†‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤™‡≥Ç‡≤∞‡≥ç‡≤£‡≤ó‡≥ä‡≤≥‡≤ø‡≤∏‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ä‡≤∞‡≤ø!", 'pass'); displayArea.textContent = "üéâ"; progressBar.style.backgroundColor = '#10b981'; } } } });
        speakButton.addEventListener('click', () => { if (isRecording) stopRecording(); const textToSpeak = activeContent[currentContentIndex]?.text; if (textToSpeak) { if (!currentItemHintUsed) { hintCounter++; hintCountSpan.textContent = hintCounter; const currentLessonTitle = activeContent[currentContentIndex].lessonTitle; if(lessonScores[currentLessonTitle]) { lessonScores[currentLessonTitle].hints++; } currentItemHintUsed = true; } speakText(textToSpeak); } });
        recordButton.addEventListener('click', () => { if (isRecording) { stopRecording(); } else { resetValidationUI(); if (synth.speaking) { synth.cancel(); } checkMicPermissionAndStart(); } });

        // --- Application Initialization ---
        function initializeApp() { console.log("Initializing App..."); appContainer.classList.add('hidden'); testResultsArea.classList.add('hidden'); testSelectionArea.classList.add('hidden'); menuPanel.classList.remove('open'); if(initializeSpeechRecognition()) { console.log("Speech Recognition Initialized."); setMode('learn'); } else { console.error("Speech recognition could not be initialized."); showMessage("‡≤ß‡≥ç‡≤µ‡≤®‡≤ø ‡≤ó‡≥Å‡≤∞‡≥Å‡≤§‡≤ø‡≤∏‡≥Å‡≤µ‡≤ø‡≤ï‡≥Ü ‡≤™‡≥ç‡≤∞‡≤æ‡≤∞‡≤Ç‡≤≠‡≤ø‡≤∏‡≤≤‡≥Å ‡≤∏‡≤æ‡≤ß‡≥ç‡≤Ø‡≤µ‡≤æ‡≤ó‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤. ‡≤™‡≤∞‡≥Ä‡≤ï‡≥ç‡≤∑‡≤æ ‡≤Æ‡≥ã‡≤°‡≥ç ‡≤≤‡≤≠‡≥ç‡≤Ø‡≤µ‡≤ø‡≤≤‡≥ç‡≤≤‡≤¶‡≤ø‡≤∞‡≤¨‡≤π‡≥Å‡≤¶‡≥Å.", 'error'); menuTestLink.style.pointerEvents = 'none'; menuTestLink.style.opacity = '0.5'; setMode('learn'); } }
        if (speechSynthesis.onvoiceschanged !== undefined) { speechSynthesis.onvoiceschanged = initializeApp; if (speechSynthesis.getVoices().length > 0) { setTimeout(initializeApp, 50); } else { console.log("Waiting for voiceschanged event..."); } } else { console.warn("onvoiceschanged not supported. Using timeout."); setTimeout(initializeApp, 500); }

    </script>

</body>
</html>
